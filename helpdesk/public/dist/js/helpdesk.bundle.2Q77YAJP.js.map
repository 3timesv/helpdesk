{
  "version": 3,
  "sources": ["../../../../../apps/helpdesk/helpdesk/public/js/utils.js"],
  "sourcesContent": ["window.FileAttachmentHandler = class FileAttachmentHandler {\n    constructor() {\n        this.add_attachment_handler()\n        this.set_listeners()\n    }\n\n    add_attachment_handler() {\n\t\tvar me = this;\n\t\t$(\".add-attachment-helpdesk\").click(function () {\n            me.new_attachment();\n\t\t});\n\t}\n\n    new_attachment() {\n\t\tnew frappe.ui.FileUploader({\n\t\t\tfolder: \"Home/Attachments\",\n\t\t\ton_success: (file_doc) => {\n                console.log(`File ${file_doc.name} uploaded`)\n                if (!this.attachments) this.attachments = [];\n\t\t\t\tif (!this.save_paths) this.save_paths = {};\n\t\t\t\tthis.attachments.push(file_doc);\n\t\t\t\t$(\".helpdesk-attachment\").empty().append(this.build_attachment_table());\n\t\t\t\t// $(\".attachment-controls\").find(\".number\").text(this.attachments.length);\n\t\t\t},\n\t\t});\n\t}\n\n    build_attachment_table() {\n        console.log('Here 10')\n\t\tvar wrapper = $('<div class=\"helpdesk-attachment\"></div>');\n\t\twrapper.empty();\n\n\t\tvar table = $(this.get_attachment_table_header_html()).appendTo(wrapper);\n\t\tif (!this.attachments || !this.attachments.length)\n\t\t\treturn \"No attachments uploaded\";\n\n\t\tthis.attachments.forEach((f) => {\n\t\t\tconst row = $(\"<tr></tr>\").appendTo(table.find(\"tbody\"));\n\t\t\t$(`<td>${f.file_name}</td>`).appendTo(row);\n\t\t\t$(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs btn-primary-light text-nowrap copy-link\" data-link=\"![](${f.file_url})\" data-name = \"${f.file_name}\" >\n\t\t\t\tCopy Link\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n\t\t\t$(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs  center delete-button\"  data-name = \"${f.file_name}\" >\n\t\t\t<svg class=\"icon icon-sm\"><use xlink:href=\"#icon-delete\"></use></svg>\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n\t\t});\n\t\treturn wrapper;\n\t}\n    \n    get_attachment_table_header_html() {\n\t\treturn `<table class=\"table  attachment-table\" \">\n\t\t\t<tbody></tbody>\n\t\t</table>`;\n\t}\n\n    handle_attachment_upload_callback(method) {\n        if(this.attachments) {\n\n        }\n    }\n\n    set_listeners() {\n\t\tvar me = this;\n\n\t\t$(`body`).on(\"click\", `.copy-link`, function () {\n\t\t\tfrappe.utils.copy_to_clipboard($(this).attr(\"data-link\"));\n\t\t});\n\n\t\t$(`body`).on(\"click\", `.delete-button`, function () {\n\t\t\tfrappe.confirm(\n\t\t\t\t`Are you sure you want to delete the file \"${$(this).attr(\n\t\t\t\t\t\"data-name\"\n\t\t\t\t)}\"`,\n\t\t\t\t() => {\n\t\t\t\t\tme.attachments.forEach((f, index, object) => {\n\t\t\t\t\t\tif (f.file_name == $(this).attr(\"data-name\")) {\n\t\t\t\t\t\t\tobject.splice(index, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$(\".helpdesk-attachment\").empty().append(me.build_attachment_table());\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n}"],
  "mappings": "MAAA,OAAO,sBAAwB,KAA4B,CACvD,aAAc,CACV,KAAK,yBACL,KAAK,gBAGT,wBAAyB,CAC3B,GAAI,GAAK,KACT,EAAE,4BAA4B,MAAM,UAAY,CACtC,EAAG,mBAIX,gBAAiB,CACnB,GAAI,QAAO,GAAG,aAAa,CAC1B,OAAQ,mBACR,WAAY,AAAC,GAAa,CACb,QAAQ,IAAI,QAAQ,EAAS,iBACxB,KAAK,aAAa,MAAK,YAAc,IACjD,KAAK,YAAY,MAAK,WAAa,IACxC,KAAK,YAAY,KAAK,GACtB,EAAE,wBAAwB,QAAQ,OAAO,KAAK,6BAM9C,wBAAyB,CACrB,QAAQ,IAAI,WAClB,GAAI,GAAU,EAAE,2CAChB,EAAQ,QAER,GAAI,GAAQ,EAAE,KAAK,oCAAoC,SAAS,GAChE,MAAI,CAAC,KAAK,aAAe,CAAC,KAAK,YAAY,OACnC,0BAER,MAAK,YAAY,QAAQ,AAAC,GAAM,CAC/B,GAAM,GAAM,EAAE,aAAa,SAAS,EAAM,KAAK,UAC/C,EAAE,OAAO,EAAE,kBAAkB,SAAS,GACtC,EAAE;AAAA,8FACyF,EAAE,2BAA2B,EAAE;AAAA;AAAA;AAAA,WAGlH,SAAS,GACjB,EAAE;AAAA,2EACsE,EAAE;AAAA;AAAA;AAAA,WAGlE,SAAS,KAEX,GAGL,kCAAmC,CACrC,MAAO;AAAA;AAAA,YAKL,kCAAkC,EAAQ,CACtC,AAAG,KAAK,YAKZ,eAAgB,CAClB,GAAI,GAAK,KAET,EAAE,QAAQ,GAAG,QAAS,aAAc,UAAY,CAC/C,OAAO,MAAM,kBAAkB,EAAE,MAAM,KAAK,gBAG7C,EAAE,QAAQ,GAAG,QAAS,iBAAkB,UAAY,CACnD,OAAO,QACN,6CAA6C,EAAE,MAAM,KACpD,gBAED,IAAM,CACL,EAAG,YAAY,QAAQ,CAAC,EAAG,EAAO,IAAW,CAC5C,AAAI,EAAE,WAAa,EAAE,MAAM,KAAK,cAC/B,EAAO,OAAO,EAAO,KAGvB,EAAE,wBAAwB,QAAQ,OAAO,EAAG",
  "names": []
}
