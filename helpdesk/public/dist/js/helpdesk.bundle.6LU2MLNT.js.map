{
  "version": 3,
  "sources": ["../../../../../apps/helpdesk/helpdesk/public/js/utils.js"],
  "sourcesContent": ["window.FileAttachmentHandler = class FileAttachmentHandler {\n    constructor() {\n        this.add_attachment_handler()\n        this.set_listeners()\n    }\n\n    add_attachment_handler() {\n\t\tvar me = this;\n\t\t$(\".add-attachment-helpdesk\").click(function () {\n            me.new_attachment();\n\t\t});\n\t}\n\n    new_attachment() {\n\t\tnew frappe.ui.FileUploader({\n\t\t\tfolder: \"Home/Attachments\",\n\t\t\ton_success: (file_doc) => {\n                console.log(`File ${file_doc.name} uploaded`)\n                if (!this.attachments) this.attachments = [];\n\t\t\t\tif (!this.save_paths) this.save_paths = {};\n\t\t\t\tthis.attachments.push(file_doc);\n\t\t\t\t$(\".helpdesk-attachment\").empty().append(this.build_attachment_table());\n\t\t\t\t// $(\".attachment-controls\").find(\".number\").text(this.attachments.length);\n\t\t\t},\n\t\t});\n\t}\n\n    build_attachment_table() {\n        console.log('Here 10')\n\t\tvar wrapper = $('<div class=\"helpdesk-attachment\"></div>');\n\t\twrapper.empty();\n\n\t\tvar table = $(this.get_attachment_table_header_html()).appendTo(wrapper);\n\t\tif (!this.attachments || !this.attachments.length)\n\t\t\treturn \"No attachments uploaded\";\n\n\t\tthis.attachments.forEach((f) => {\n\t\t\tconst row = $(\"<tr></tr>\").appendTo(table.find(\"tbody\"));\n\t\t\t$(`<td>${f.file_name}</td>`).appendTo(row);\n\t\t\t$(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs btn-primary-light text-nowrap copy-link\" data-link=\"![](${f.file_url})\" data-name = \"${f.file_name}\" >\n\t\t\t\tCopy Link\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n\t\t\t$(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs  center delete-button\"  data-name = \"${f.file_name}\" >\n\t\t\t<svg class=\"icon icon-sm\"><use xlink:href=\"#icon-delete\"></use></svg>\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n\t\t});\n\t\treturn wrapper;\n\t}\n    \n    get_attachment_table_header_html() {\n\t\treturn `<table class=\"table  attachment-table\" \">\n\t\t\t<tbody></tbody>\n\t\t</table>`;\n\t}\n\n    handle_attachment_upload_callback(method) {\n        if(this.attachments) {\n\n        }\n    }\n\n    set_listeners() {\n\t\tvar me = this;\n\n\t\t$(`body`).on(\"click\", `.copy-link`, function () {\n\t\t\tfrappe.utils.copy_to_clipboard($(this).attr(\"data-link\"));\n\t\t});\n\n\t\t$(`body`).on(\"click\", `.delete-button`, function () {\n\t\t\tfrappe.confirm(\n\t\t\t\t`Are you sure you want to delete the file \"${$(this).attr(\n\t\t\t\t\t\"data-name\"\n\t\t\t\t)}\"`,\n\t\t\t\t() => {\n\t\t\t\t\tme.attachments.forEach((f, index, object) => {\n\t\t\t\t\t\tif (f.file_name == $(this).attr(\"data-name\")) {\n\t\t\t\t\t\t\tobject.splice(index, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$(\".helpdesk-attachment\").empty().append(me.build_attachment_table());\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n}"],
  "mappings": ";;AAAA,SAAO,wBAAwB,4BAA4B;AAAA,IACvD,cAAc;AACV,WAAK;AACL,WAAK;AAAA;AAAA,IAGT,yBAAyB;AAC3B,UAAI,KAAK;AACT,QAAE,4BAA4B,MAAM,WAAY;AACtC,WAAG;AAAA;AAAA;AAAA,IAIX,iBAAiB;AACnB,UAAI,OAAO,GAAG,aAAa;AAAA,QAC1B,QAAQ;AAAA,QACR,YAAY,CAAC,aAAa;AACb,kBAAQ,IAAI,QAAQ,SAAS;AAC7B,cAAI,CAAC,KAAK;AAAa,iBAAK,cAAc;AACtD,cAAI,CAAC,KAAK;AAAY,iBAAK,aAAa;AACxC,eAAK,YAAY,KAAK;AACtB,YAAE,wBAAwB,QAAQ,OAAO,KAAK;AAAA;AAAA;AAAA;AAAA,IAM9C,yBAAyB;AACrB,cAAQ,IAAI;AAClB,UAAI,UAAU,EAAE;AAChB,cAAQ;AAER,UAAI,QAAQ,EAAE,KAAK,oCAAoC,SAAS;AAChE,UAAI,CAAC,KAAK,eAAe,CAAC,KAAK,YAAY;AAC1C,eAAO;AAER,WAAK,YAAY,QAAQ,CAAC,MAAM;AAC/B,cAAM,MAAM,EAAE,aAAa,SAAS,MAAM,KAAK;AAC/C,UAAE,OAAO,EAAE,kBAAkB,SAAS;AACtC,UAAE;AAAA,8FACyF,EAAE,2BAA2B,EAAE;AAAA;AAAA;AAAA,WAGlH,SAAS;AACjB,UAAE;AAAA,2EACsE,EAAE;AAAA;AAAA;AAAA,WAGlE,SAAS;AAAA;AAElB,aAAO;AAAA;AAAA,IAGL,mCAAmC;AACrC,aAAO;AAAA;AAAA;AAAA;AAAA,IAKL,kCAAkC,QAAQ;AACtC,UAAG,KAAK,aAAa;AAAA;AAAA;AAAA,IAKzB,gBAAgB;AAClB,UAAI,KAAK;AAET,QAAE,QAAQ,GAAG,SAAS,cAAc,WAAY;AAC/C,eAAO,MAAM,kBAAkB,EAAE,MAAM,KAAK;AAAA;AAG7C,QAAE,QAAQ,GAAG,SAAS,kBAAkB,WAAY;AACnD,eAAO,QACN,6CAA6C,EAAE,MAAM,KACpD,iBAED,MAAM;AACL,aAAG,YAAY,QAAQ,CAAC,GAAG,OAAO,WAAW;AAC5C,gBAAI,EAAE,aAAa,EAAE,MAAM,KAAK,cAAc;AAC7C,qBAAO,OAAO,OAAO;AAAA;AAAA;AAGvB,YAAE,wBAAwB,QAAQ,OAAO,GAAG;AAAA;AAAA;AAAA;AAAA;",
  "names": []
}
