import{L as R}from"./ListManager-d2a1afc7.js";import{_ as C,D as b,I as T,s as V,p as f,o as E,d as v,i as o,w as r,b as a,k as w,r as n,v as M,t as x}from"./index-d9377e3a.js";import{E as D}from"./ErrorMessage-e4ff6432.js";import{T as k,a as y}from"./TextEditor-b1ee2b34.js";import{L as A}from"./ListViewer-af42e401.js";import"./Dropdown-e0c50cd3.js";import"./use-tracked-pointer-4b3ac621.js";import"./use-resolve-button-type-390b11ae.js";import"./CustomIcons-60888788.js";import"./listFilters-8ea4c2e9.js";import"./Autocomplete-c752a27e.js";import"./use-controllable-93c8440b.js";import"./CustomSwitch-323f8131.js";const $={name:"AddNewCannedResponsesDialog",props:["show"],components:{Dialog:b,Input:T,FeatherIcon:V,ErrorMessage:D,TextEditor:k,TextEditorFixedMenu:y},setup(){const e=f(""),t=f("");return{titleValidationError:e,messageValidationError:t}},data(){return{title:"",message:""}},watch:{title(e){this.validateTitle(e)},message(e){this.validateMessage(e)}},computed:{textEditorMenuButtons(){return["Paragraph",["Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"]}},methods:{close(){this.title="",this.message="",this.$emit("close")},addResponse(){if(this.validateInputs())return;const e={title:this.title,message:this.message};this.$resources.newResponse.submit({doc:{doctype:"HD Canned Response",...e}})},validateInputs(){let e=this.validateTitle(this.title);return e+=this.validateMessage(this.message),e},validateTitle(e){return this.titleValidationError="",e?e.trim()==""&&(this.titleValidationError="Title is required"):this.titleValidationError="Title is required",this.titleValidationError},validateMessage(e){return this.messageValidationError="",e?["<p><br></p>","<p></p>"].includes(e.replaceAll(" ",""))&&(this.messageValidationError="Message is required"):this.messageValidationError="Message is required",this.messageValidationError}},resources:{newResponse(){return{url:"frappe.client.insert",onSuccess:e=>{this.$router.push(`/frappedesk/settings/canned_responses/${e.name}`)},onError:e=>{this.$toast({title:"Error while creating canned response",text:e,icon:"x",iconClasses:"text-red-500"})}}}}},B={class:"flex flex-col mt-6"},L=a("div",{class:"mb-2 block text-sm leading-4 text-gray-700 mt-4"}," Message ",-1);function N(e,t,_,i,l,d){const m=n("Input"),p=n("ErrorMessage"),u=n("TextEditorFixedMenu"),g=n("TextEditor"),h=n("Button"),c=n("Dialog");return E(),v("div",null,[o(c,{options:{title:"New canned response",size:"3xl"},show:_.show,onClose:t[3]||(t[3]=s=>d.close()),class:"bg-white px-6 py-5 pb-1 pt-6"},{"body-content":r(()=>[a("div",B,[o(m,{id:"searchInput",class:"w-full",type:"text",label:"Title",placeholder:"Enter Title",modelValue:l.title,"onUpdate:modelValue":t[0]||(t[0]=s=>l.title=s)},null,8,["modelValue"]),o(p,{message:i.titleValidationError},null,8,["message"])]),L,a("div",null,[o(g,{class:"bg-gray-100",ref:"textEditor","editor-class":"min-h-[20rem] overflow-y-auto max-h-[73vh] w-full px-3 max-w-full",content:l.message,"starterkit-options":{heading:{levels:[2,3,4,5,6]}},onChange:t[1]||(t[1]=s=>{l.message=s})},{top:r(()=>[a("div",null,[o(u,{class:"m-3 overflow-x-auto",buttons:d.textEditorMenuButtons},null,8,["buttons"])])]),_:1},8,["content"])]),o(p,{message:i.messageValidationError},null,8,["message"])]),actions:r(()=>[o(h,{appearance:"primary",onClick:t[2]||(t[2]=s=>d.addResponse()),class:"mr-auto"},{default:r(()=>[w("Add Response")]),_:1})]),_:1},8,["show"])])}const H=C($,[["render",N]]),I={name:"Canned Responses",components:{ListManager:R,AddNewCannedResponsesDialog:H,ListViewer:A},setup(){const e=M("viewportWidth"),t=f(!1);return{viewportWidth:e,showNewCannedResponsesDialog:t}},mounted(){this.$event.emit("set-selected-setting","Canned Responses")},resources:{deleteTeam(){return{url:"frappe.client.delete"}},bulk_delete_responses(){return{url:"frappedesk.api.doc.delete_items",onSuccess:()=>{this.$router.go()},onError:e=>{this.$refs.listManager.manager.reload(),this.$toast({title:"Error while deleting canned responses",text:e,icon:"check",iconClasses:"text-red-500"})}}}}},S={class:"flex flex-col px-4"},F={class:"font-inter text-[13px] text-gray-600"},q={class:"flex flex-row space-x-2"};function j(e,t,_,i,l,d){const m=n("router-link"),p=n("Button"),u=n("ListViewer"),g=n("ListManager"),h=n("AddNewCannedResponsesDialog");return E(),v("div",S,[o(g,{ref:"listManager",options:{doctype:"HD Canned Response",urlQueryFilters:!0,saveFiltersLocally:!0,fields:["title","owner"],limit:20,order_by:"modified desc"}},{body:r(({manager:c})=>[o(u,{options:{name:"Response",base:"12",listTitle:"Canned Responses",filterBox:!0,presetFilters:!0,fields:{title:{label:"Title",width:"4"},owner:{label:"Owner",width:"2"}}},class:"h-[calc(100vh-9.5rem)] pt-4 text-base",onAddItem:t[0]||(t[0]=()=>{i.showNewCannedResponsesDialog=!0})},{"field-title":r(({row:s})=>[o(m,{to:{path:`/frappedesk/settings/canned_responses/${s.title}`},class:"font-inter text-[13px] text-gray-600 hover:text-gray-900"},{default:r(()=>[w(x(`${s.title}`),1)]),_:2},1032,["to"])]),"field-owner":r(({row:s})=>[a("div",F,x(s.owner),1)]),"bulk-actions":r(({selectedItems:s})=>[a("div",q,[o(p,{onClick:()=>{e.$resources.deleteTeam.submit({doctype:"HD Canned Response",name:Object.keys(s)}).then(()=>{c.unselect(),c.reload()})}},{default:r(()=>[w("Delete")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:1},512),o(h,{show:i.showNewCannedResponsesDialog,onClose:t[1]||(t[1]=()=>{i.showNewCannedResponsesDialog=!1,e.$refs.listManager.manager.reload(),e.$router.go()})},null,8,["show"])])}const te=C(I,[["render",j]]);export{te as default};
