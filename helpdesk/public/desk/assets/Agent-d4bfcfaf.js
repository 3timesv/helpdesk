import{_ as v,s as $,I as A,p as _,o as m,d as u,b as n,t as x,i as s,w as l,k as h,c as T,m as N,r as a,F as S,e as V,h as F,T as C}from"./index-d9377e3a.js";import{F as U}from"./FileUploader-997fc331.js";import{U as D}from"./UserAvatar-3798c645.js";import{L as P}from"./ListManager-d2a1afc7.js";import{L}from"./ListViewer-af42e401.js";import{T as R,a as j,S as B}from"./Subject-97b60af0.js";import{T as M}from"./TicketStatus-1f4b539e.js";import"./Avatar-166461f8.js";import"./Dropdown-e0c50cd3.js";import"./use-tracked-pointer-4b3ac621.js";import"./use-resolve-button-type-390b11ae.js";import"./CustomIcons-60888788.js";import"./listFilters-8ea4c2e9.js";import"./Autocomplete-c752a27e.js";import"./use-controllable-93c8440b.js";import"./CustomSwitch-323f8131.js";import"./ErrorMessage-e4ff6432.js";const z={name:"AgentInfo",props:["agent"],components:{FeatherIcon:$,Input:A,FileUploader:U,UserAvatar:D},setup(){const t=_(!1),e=_(""),d=_(!1);return{editingName:t,tempAgentName:e,updatingValues:d}},computed:{agentDoc(){return this.tempAgentName=this.$resources.agent?.doc?.agent_name,this.$resources.agent.doc||null},userDoc(){return this.$resources.user.doc||null},values(){return this.updatingValues?this.values||null:{agentName:this.agentDoc?.agent_name||null,profilePicture:this.userDoc?.user_image||null,team:this.agentDoc?.group||null,email:this.userDoc?.email||null,signature:this.userDoc?.email_signature||null}},teams(){return this.$resources.teams.data?this.$resources.teams.data.map(t=>t.name):[]}},deactivated(){this.resetForm()},resources:{agent(){return{type:"document",doctype:"HD Agent",name:this.agent,setValue:{onSuccess:()=>{this.resetForm(),this.updatingValues=!1,this.$toast({title:"Agent Updated.",icon:"check",iconClasses:"text-green-500"}),this.$router.go()}}}},user(){return{type:"document",doctype:"User",name:this.agent}},teams(){return{type:"list",doctype:"HD Team",fields:["name"]}}},methods:{setUserImage(t){this.$resources.user.setValue.submit({user_image:t}),this.$router.go()},resetForm(){this.editingName=!1,this.tempAgentName=this.values.agentName},save(){this.updatingValues=!0;const t=this.values;this.$resources.user.setValue.submit({email:t.email,email_signature:t.signature,first_name:this.tempAgentName.split(" ")[0],last_name:this.tempAgentName.slice(this.tempAgentName.indexOf(" ")+1)}).then(()=>{this.$resources.agent.setValue.submit({agent_name:this.tempAgentName,group:t.team})})},cancel(){this.$router.go()}}},E={class:"min-w-[390px] px-[24px] py-[10px]"},H={class:"form w-full flex flex-col"},K={key:0,class:"flex space-x-2 items-center cursor-pointer"},O={class:"font-semibold"},q={key:1,class:"flex space-x-2 items-center"},G={class:"flex flex-col space-y-[24px]"},J=n("span",{class:"block mb-2 text-sm leading-4 text-gray-700"},"Profile Picture",-1),Q={class:"flex flex-row space-x-[8px] items-center"},W={class:"flex items-center space-x-2"},X=n("div",{class:"flex flex-row space-x-[16px]"},null,-1),Y={class:"w-full flex flex-row"},Z={class:"grow flex flex-row-reverse"};function ee(t,e,d,i,k,o){const r=a("FeatherIcon"),g=a("Input"),b=a("UserAvatar"),f=a("Button"),y=a("FileUploader");return m(),u("div",E,[n("div",H,[n("div",{class:"float-left mb-[16px]",onClick:e[2]||(e[2]=()=>{i.editingName=!0,i.tempAgentName=o.values.agentName})},[i.editingName?(m(),u("div",q,[s(g,{id:"agentNameInput",modelValue:i.tempAgentName,"onUpdate:modelValue":e[0]||(e[0]=p=>i.tempAgentName=p),type:"text"},null,8,["modelValue"]),s(r,{class:"w-4 h-4",role:"button",name:"x",onClick:e[1]||(e[1]=()=>{i.editingName=!1,i.tempAgentName=o.values.agentName})})])):(m(),u("div",K,[n("div",O,x(o.values.agentName),1),s(r,{class:"w-3 h-3",name:"edit"})]))]),n("div",G,[n("div",null,[J,n("div",Q,[s(y,{onSuccess:e[4]||(e[4]=p=>o.setUserImage(p.file_url))},{default:l(({file:p,progress:w,uploading:c,openFileSelector:I})=>[n("div",W,[s(b,{size:"lg",fullName:o.userDoc?.full_name,userImage:o.userDoc?.user_image},null,8,["fullName","userImage"]),s(f,{onClick:I},{default:l(()=>[h(x(c?`Uploading ${w}%`:"Upload Image"),1)]),_:2},1032,["onClick"]),o.userDoc?.user_image?(m(),T(f,{key:0,onClick:e[3]||(e[3]=ke=>o.setUserImage(null))},{default:l(()=>[h(" Remove ")]),_:1})):N("",!0)])]),_:1})])]),X,n("div",Y,[n("div",null,[s(f,{onClick:e[5]||(e[5]=p=>o.cancel())},{default:l(()=>[h("Cancel")]),_:1})]),n("div",Z,[s(f,{loading:this.$resources.agent.setValue.loading||this.$resources.user.setValue.loading,appearance:"primary",onClick:e[6]||(e[6]=p=>o.save())},{default:l(()=>[h("Save")]),_:1},8,["loading"])])])])])])}const te=v(z,[["render",ee]]),se={name:"AgentRelatedInfoTopPanel",setup(){return{options:_([])}},mounted(){this.options=[{label:"Tickets",name:"tickets",action:()=>{this.changeSection("tickets")},selected:!0},{label:"Knowledge Base",name:"kb",action:()=>{this.changeSection("kb")}}]},methods:{changeSection(t){this.options.forEach(e=>{e.selected=e.name===t}),this.$event.emit("agent-related-info-top-panel-selection-change",t)}}},ne={class:"flex flex-row border-b border-[#F4F5F6] text-base font-normal"},ae=["onClick"];function oe(t,e,d,i,k,o){return m(),u("div",ne,[(m(!0),u(S,null,V(i.options,r=>(m(),u("div",{key:r.name,class:"grow"},[n("div",{role:"button",onClick:g=>r.action(),class:F(["text-center py-[12px] mb-[-1px]",r.selected?"border-b border-blue-500 text-gray-900":"text-gray-600"])},x(r.label),11,ae)]))),128))])}const ie=v(se,[["render",oe]]),le={name:"RelatedInfo",props:["agent"],components:{AgentRelatedInfoTopPanel:ie,FeatherIcon:$,Tooltip:C,ListManager:P,ListViewer:L,TicketType:R,TicketStatus:M,TicketPriority:j,Subject:B},setup(){return{relatedInfoToShow:_("tickets")}},mounted(){this.$event.on("agent-related-info-top-panel-selection-change",t=>{this.relatedInfoToShow=t})},unmounted(){this.$event.off("agent-related-info-top-panel-selection-change")}},re={class:"flex flex-col w-full"},ce={key:0,class:"w-full px-4"},me=n("div",null,null,-1),ue={class:"text-xs text-gray-500"},de={key:1,class:"h-full w-full flex max-w-full grow-0"},pe=n("div",{class:"mx-auto my-auto text-base font-normal"}," Comming Soon ",-1),ge=[pe];function fe(t,e,d,i,k,o){const r=a("AgentRelatedInfoTopPanel"),g=a("Subject"),b=a("TicketStatus"),f=a("TicketPriority"),y=a("TicketType"),p=a("ListViewer"),w=a("ListManager");return m(),u("div",re,[s(r),i.relatedInfoToShow==="tickets"?(m(),u("div",ce,[s(w,{ref:"miniTicketList",options:{doctype:"Ticket",fields:["_assign","status","priority","subject","ticket_type","name","_seen"],limit:20,order_by:"modified desc",filters:{_assign:["like",`%${d.agent}%`]}}},{body:l(()=>[s(p,{options:{base:12,fields:{name:{label:"#",width:"1"},subject:{label:"Subject",width:"5"},status:{label:"Status",width:"2"},ticket_type:{label:"Type",width:"2"},priority:{label:"Priority",width:"2",align:"right"}}},class:"text-base h-[calc(100vh-9rem)] pt-4"},{"top-section":l(()=>[me]),"field-name":l(({value:c})=>[n("div",ue,x(c),1)]),"field-subject":l(({row:c})=>[s(g,{ticket:c},null,8,["ticket"])]),"field-status":l(({value:c})=>[s(b,{value:c},null,8,["value"])]),"field-priority":l(({value:c})=>[s(f,{value:c},null,8,["value"])]),"field-ticket_type":l(({value:c})=>[s(y,{value:c},null,8,["value"])]),_:1})]),_:1},8,["options"])])):(m(),u("div",de,ge))])}const _e=v(le,[["render",fe]]),he={name:"Agent",props:["agentId"],components:{AgentInfo:te,AgentRelatedInfo:_e},setup(){},mounted(){this.$event.emit("set-selected-setting","Agents"),this.$event.emit("show-top-panel-actions-settings","Agent")}},xe={class:"flex flex-row w-full h-full"};function ve(t,e,d,i,k,o){const r=a("AgentInfo"),g=a("AgentRelatedInfo");return m(),u("div",xe,[s(r,{class:"shrink-0 border-r border-[#F4F5F6]",agent:d.agentId},null,8,["agent"]),s(g,{class:"grow",agent:d.agentId},null,8,["agent"])])}const je=v(he,[["render",ve]]);export{je as default};
