import{C as M,p as k,M as g,W as E,X as h,Y as ie,H as re,a1 as se,a2 as W,a0 as S,R as te,O as $,U as oe,a3 as de,a4 as pe,a5 as ce,a6 as q,a7 as le,F as ne,a8 as H,aa as X,Q as ee,a9 as ve,ab as be,V as L,v as fe,ac as me,ad as _,cF as xe,_ as he,P as ye,ca as ge,r as D,o as F,c as z,w as N,i as K,b as j,a as Z,h as G,d as J,t as Q,m as ae,x as Oe,e as Ce,at as Se}from"./index-d9377e3a.js";import{C as Re}from"./CustomIcons-60888788.js";import{x as we,a as P,p as Ie,u as Pe}from"./use-tracked-pointer-4b3ac621.js";import{b as Ve}from"./use-resolve-button-type-390b11ae.js";import{d as _e,e as ke}from"./use-controllable-93c8440b.js";function Te(e,f){return e===f}var Be=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Be||{}),De=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(De||{}),Ee=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ee||{});let ue=Symbol("ComboboxContext");function U(e){let f=fe(ue,null);if(f===null){let c=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,U),c}return f}let Fe=M({name:"Combobox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>Te},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},name:{type:String},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:f,attrs:c,emit:V}){let t=k(1),o=k(null),d=k(null),O=k(null),u=k(null),b=k({static:!1,hold:!1}),m=k([]),y=k(null),R=k(1),w=k(!1);function T(n=p=>p){let p=y.value!==null?m.value[y.value]:null,v=me(n(m.value.slice()),x=>S(x.dataRef.domRef)),i=p?v.indexOf(p):null;return i===-1&&(i=null),{options:v,activeOptionIndex:i}}let a=g(()=>e.multiple?1:0),l=g(()=>e.nullable),[r,I]=_e(g(()=>e.modelValue===void 0?E(a.value,{[1]:[],[0]:void 0}):e.modelValue),n=>V("update:modelValue",n),g(()=>e.defaultValue)),s={comboboxState:t,value:r,mode:a,compare(n,p){if(typeof e.by=="string"){let v=e.by;return n?.[v]===p?.[v]}return e.by(n,p)},defaultValue:g(()=>e.defaultValue),nullable:l,inputRef:d,labelRef:o,buttonRef:O,optionsRef:u,disabled:g(()=>e.disabled),options:m,change(n){I(n)},activeOptionIndex:g(()=>{if(w.value&&y.value===null&&m.value.length>0){let n=m.value.findIndex(p=>!p.dataRef.disabled);if(n!==-1)return n}return y.value}),activationTrigger:R,optionsPropsRef:b,closeCombobox(){w.value=!1,!e.disabled&&t.value!==1&&(t.value=1,y.value=null)},openCombobox(){if(w.value=!0,e.disabled||t.value===0)return;let n=m.value.findIndex(p=>{let v=h(p.dataRef.value);return E(a.value,{[0]:()=>s.compare(h(s.value.value),h(v)),[1]:()=>h(s.value.value).some(i=>s.compare(h(i),h(v)))})});n!==-1&&(y.value=n),t.value=0},goToOption(n,p,v){if(w.value=!1,e.disabled||u.value&&!b.value.static&&t.value===1)return;let i=T();if(i.activeOptionIndex===null){let C=i.options.findIndex(Y=>!Y.dataRef.disabled);C!==-1&&(i.activeOptionIndex=C)}let x=we(n===P.Specific?{focus:P.Specific,id:p}:{focus:n},{resolveItems:()=>i.options,resolveActiveIndex:()=>i.activeOptionIndex,resolveId:C=>C.id,resolveDisabled:C=>C.dataRef.disabled});y.value=x,R.value=v??1,m.value=i.options},selectOption(n){let p=m.value.find(i=>i.id===n);if(!p)return;let{dataRef:v}=p;I(E(a.value,{[0]:()=>v.value,[1]:()=>{let i=h(s.value.value).slice(),x=h(v.value),C=i.findIndex(Y=>s.compare(x,h(Y)));return C===-1?i.push(x):i.splice(C,1),i}}))},selectActiveOption(){if(s.activeOptionIndex.value===null)return;let{dataRef:n,id:p}=m.value[s.activeOptionIndex.value];I(E(a.value,{[0]:()=>n.value,[1]:()=>{let v=h(s.value.value).slice(),i=h(n.value),x=v.findIndex(C=>s.compare(i,h(C)));return x===-1?v.push(i):v.splice(x,1),v}})),s.goToOption(P.Specific,p)},registerOption(n,p){let v={id:n,dataRef:p},i=T(x=>[...x,v]);if(y.value===null){let x=p.value.value;E(a.value,{[0]:()=>s.compare(h(s.value.value),h(x)),[1]:()=>h(s.value.value).some(C=>s.compare(h(C),h(x)))})&&(i.activeOptionIndex=i.options.indexOf(v))}m.value=i.options,y.value=i.activeOptionIndex,R.value=1},unregisterOption(n){var p;s.activeOptionIndex.value!==null&&((p=s.options.value[s.activeOptionIndex.value])==null?void 0:p.id)===n&&(w.value=!0);let v=T(i=>{let x=i.findIndex(C=>C.id===n);return x!==-1&&i.splice(x,1),i});m.value=v.options,y.value=v.activeOptionIndex,R.value=1}};ie([d,O,u],()=>s.closeCombobox(),g(()=>t.value===0)),re(ue,s),se(g(()=>E(t.value,{[0]:W.Open,[1]:W.Closed})));let A=g(()=>s.activeOptionIndex.value===null?null:m.value[s.activeOptionIndex.value].dataRef.value),B=g(()=>{var n;return(n=S(d))==null?void 0:n.closest("form")});return te(()=>{$([B],()=>{if(!B.value||e.defaultValue===void 0)return;function n(){s.change(e.defaultValue)}return B.value.addEventListener("reset",n),()=>{var p;(p=B.value)==null||p.removeEventListener("reset",n)}},{immediate:!0})}),()=>{let{name:n,disabled:p,...v}=e,i={open:t.value===0,disabled:p,activeIndex:s.activeOptionIndex.value,activeOption:A.value,value:r.value};return oe(ne,[...n!=null&&r.value!=null?ke({[n]:r.value}).map(([x,C])=>oe(de,pe({features:ce.Hidden,key:x,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:x,value:C}))):[],q({theirProps:{...c,...le(v,["modelValue","defaultValue","nullable","multiple","onUpdate:modelValue","by"])},ourProps:{},slot:i,slots:f,attrs:c,name:"Combobox"})])}}});M({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:()=>`headlessui-combobox-label-${H()}`}},setup(e,{attrs:f,slots:c}){let V=U("ComboboxLabel");function t(){var o;(o=S(V.inputRef))==null||o.focus({preventScroll:!0})}return()=>{let o={open:V.comboboxState.value===0,disabled:V.disabled.value},{id:d,...O}=e,u={id:d,ref:V.labelRef,onClick:t};return q({ourProps:u,theirProps:O,slot:o,attrs:f,slots:c,name:"ComboboxLabel"})}}});let Ae=M({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-combobox-button-${H()}`}},setup(e,{attrs:f,slots:c,expose:V}){let t=U("ComboboxButton");V({el:t.buttonRef,$el:t.buttonRef});function o(u){t.disabled.value||(t.comboboxState.value===0?t.closeCombobox():(u.preventDefault(),t.openCombobox()),L(()=>{var b;return(b=S(t.inputRef))==null?void 0:b.focus({preventScroll:!0})}))}function d(u){switch(u.key){case _.ArrowDown:u.preventDefault(),u.stopPropagation(),t.comboboxState.value===1&&t.openCombobox(),L(()=>{var b;return(b=t.inputRef.value)==null?void 0:b.focus({preventScroll:!0})});return;case _.ArrowUp:u.preventDefault(),u.stopPropagation(),t.comboboxState.value===1&&(t.openCombobox(),L(()=>{t.value.value||t.goToOption(P.Last)})),L(()=>{var b;return(b=t.inputRef.value)==null?void 0:b.focus({preventScroll:!0})});return;case _.Escape:if(t.comboboxState.value!==0)return;u.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&u.stopPropagation(),t.closeCombobox(),L(()=>{var b;return(b=t.inputRef.value)==null?void 0:b.focus({preventScroll:!0})});return}}let O=Ve(g(()=>({as:e.as,type:f.type})),t.buttonRef);return()=>{var u,b;let m={open:t.comboboxState.value===0,disabled:t.disabled.value,value:t.value.value},{id:y,...R}=e,w={ref:t.buttonRef,id:y,type:O.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(u=S(t.optionsRef))==null?void 0:u.id,"aria-expanded":t.disabled.value?void 0:t.comboboxState.value===0,"aria-labelledby":t.labelRef.value?[(b=S(t.labelRef))==null?void 0:b.id,y].join(" "):void 0,disabled:t.disabled.value===!0?!0:void 0,onKeydown:d,onClick:o};return q({ourProps:w,theirProps:R,slot:m,attrs:f,slots:c,name:"ComboboxButton"})}}}),Ne=M({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:()=>`headlessui-combobox-input-${H()}`}},emits:{change:e=>!0},setup(e,{emit:f,attrs:c,slots:V,expose:t}){let o=U("ComboboxInput"),d={value:!1};t({el:o.inputRef,$el:o.inputRef});let O=g(()=>{var a;let l=o.value.value;return S(o.inputRef)?typeof e.displayValue<"u"&&l!==void 0?(a=e.displayValue(l))!=null?a:"":typeof l=="string"?l:"":""});te(()=>{$([O,o.comboboxState],([a,l],[r,I])=>{if(d.value)return;let s=S(o.inputRef);s&&(I===0&&l===1||a!==r)&&(s.value=a)},{immediate:!0}),$([o.comboboxState],([a],[l])=>{if(a===0&&l===1){let r=S(o.inputRef);if(!r)return;let I=r.value,{selectionStart:s,selectionEnd:A,selectionDirection:B}=r;r.value="",r.value=I,B!==null?r.setSelectionRange(s,A,B):r.setSelectionRange(s,A)}})});let u=k(!1);function b(){u.value=!0}function m(){setTimeout(()=>{u.value=!1})}function y(a){switch(d.value=!0,a.key){case _.Backspace:case _.Delete:if(o.mode.value!==0||!o.nullable.value)return;let l=a.currentTarget;requestAnimationFrame(()=>{if(l.value===""){o.change(null);let r=S(o.optionsRef);r&&(r.scrollTop=0),o.goToOption(P.Nothing)}});break;case _.Enter:if(d.value=!1,o.comboboxState.value!==0||u.value)return;if(a.preventDefault(),a.stopPropagation(),o.activeOptionIndex.value===null){o.closeCombobox();return}o.selectActiveOption(),o.mode.value===0&&o.closeCombobox();break;case _.ArrowDown:return d.value=!1,a.preventDefault(),a.stopPropagation(),E(o.comboboxState.value,{[0]:()=>o.goToOption(P.Next),[1]:()=>o.openCombobox()});case _.ArrowUp:return d.value=!1,a.preventDefault(),a.stopPropagation(),E(o.comboboxState.value,{[0]:()=>o.goToOption(P.Previous),[1]:()=>{o.openCombobox(),L(()=>{o.value.value||o.goToOption(P.Last)})}});case _.Home:if(a.shiftKey)break;return d.value=!1,a.preventDefault(),a.stopPropagation(),o.goToOption(P.First);case _.PageUp:return d.value=!1,a.preventDefault(),a.stopPropagation(),o.goToOption(P.First);case _.End:if(a.shiftKey)break;return d.value=!1,a.preventDefault(),a.stopPropagation(),o.goToOption(P.Last);case _.PageDown:return d.value=!1,a.preventDefault(),a.stopPropagation(),o.goToOption(P.Last);case _.Escape:if(d.value=!1,o.comboboxState.value!==0)return;a.preventDefault(),o.optionsRef.value&&!o.optionsPropsRef.value.static&&a.stopPropagation(),o.closeCombobox();break;case _.Tab:if(d.value=!1,o.comboboxState.value!==0)return;o.mode.value===0&&o.selectActiveOption(),o.closeCombobox();break}}function R(a){o.openCombobox(),f("change",a)}function w(){d.value=!1}let T=g(()=>{var a,l,r,I;return(I=(r=(l=e.defaultValue)!=null?l:o.defaultValue.value!==void 0?(a=e.displayValue)==null?void 0:a.call(e,o.defaultValue.value):null)!=null?r:o.defaultValue.value)!=null?I:""});return()=>{var a,l,r,I,s,A;let B={open:o.comboboxState.value===0},{id:n,displayValue:p,onChange:v,...i}=e,x={"aria-controls":(a=o.optionsRef.value)==null?void 0:a.id,"aria-expanded":o.disabled.value?void 0:o.comboboxState.value===0,"aria-activedescendant":o.activeOptionIndex.value===null||(l=o.options.value[o.activeOptionIndex.value])==null?void 0:l.id,"aria-labelledby":(s=(r=S(o.labelRef))==null?void 0:r.id)!=null?s:(I=S(o.buttonRef))==null?void 0:I.id,"aria-autocomplete":"list",id:n,onCompositionstart:b,onCompositionend:m,onKeydown:y,onInput:R,onBlur:w,role:"combobox",type:(A=c.type)!=null?A:"text",tabIndex:0,ref:o.inputRef,defaultValue:T.value};return q({ourProps:x,theirProps:i,slot:B,attrs:c,slots:V,features:X.RenderStrategy|X.Static,name:"ComboboxInput"})}}}),Le=M({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(e,{attrs:f,slots:c,expose:V}){let t=U("ComboboxOptions"),o=`headlessui-combobox-options-${H()}`;V({el:t.optionsRef,$el:t.optionsRef}),ee(()=>{t.optionsPropsRef.value.static=e.static}),ee(()=>{t.optionsPropsRef.value.hold=e.hold});let d=ve(),O=g(()=>d!==null?(d.value&W.Open)===W.Open:t.comboboxState.value===0);return Ie({container:g(()=>S(t.optionsRef)),enabled:g(()=>t.comboboxState.value===0),accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}}),()=>{var u,b,m;let y={open:t.comboboxState.value===0},R={"aria-labelledby":(m=(u=S(t.labelRef))==null?void 0:u.id)!=null?m:(b=S(t.buttonRef))==null?void 0:b.id,id:o,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0},w=le(e,["hold"]);return q({ourProps:R,theirProps:w,slot:y,attrs:f,slots:c,features:X.RenderStrategy|X.Static,visible:O.value,name:"ComboboxOptions"})}}}),je=M({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{slots:f,attrs:c,expose:V}){let t=U("ComboboxOption"),o=`headlessui-combobox-option-${H()}`,d=k(null);V({el:d,$el:d});let O=g(()=>t.activeOptionIndex.value!==null?t.options.value[t.activeOptionIndex.value].id===o:!1),u=g(()=>E(t.mode.value,{[0]:()=>t.compare(h(t.value.value),h(e.value)),[1]:()=>h(t.value.value).some(l=>t.compare(h(l),h(e.value)))})),b=g(()=>({disabled:e.disabled,value:e.value,domRef:d}));te(()=>t.registerOption(o,b)),be(()=>t.unregisterOption(o)),ee(()=>{t.comboboxState.value===0&&O.value&&t.activationTrigger.value!==0&&L(()=>{var l,r;return(r=(l=S(d))==null?void 0:l.scrollIntoView)==null?void 0:r.call(l,{block:"nearest"})})});function m(l){if(e.disabled)return l.preventDefault();t.selectOption(o),t.mode.value===0&&t.closeCombobox(),xe()||requestAnimationFrame(()=>{var r;return(r=S(t.inputRef))==null?void 0:r.focus()})}function y(){if(e.disabled)return t.goToOption(P.Nothing);t.goToOption(P.Specific,o)}let R=Pe();function w(l){R.update(l)}function T(l){R.wasMoved(l)&&(e.disabled||O.value||t.goToOption(P.Specific,o,0))}function a(l){R.wasMoved(l)&&(e.disabled||O.value&&(t.optionsPropsRef.value.hold||t.goToOption(P.Nothing)))}return()=>{let{disabled:l}=e,r={active:O.value,selected:u.value,disabled:l},I={id:o,ref:d,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":u.value,disabled:void 0,onClick:m,onFocus:y,onPointerenter:w,onMouseenter:w,onPointermove:T,onMousemove:T,onPointerleave:a,onMouseleave:a};return q({ourProps:I,theirProps:e,slot:r,attrs:c,slots:f,name:"ComboboxOption"})}}});const Me={name:"Autocomplete",props:{modelValue:{type:Object,default:null},options:{type:Array,default:()=>[]},resourceOptions:{type:Function,default:()=>{}},placeholder:{type:String},searchable:{type:Boolean,default:!0},width:{type:Number,default:250},show:{type:Boolean,default:!1}},emits:["update:modelValue","change"],components:{Popover:ye,CustomIcons:Re,Combobox:Fe,ComboboxInput:Ne,ComboboxOptions:Le,ComboboxOption:je,ComboboxButton:Ae},data(){return{query:""}},mounted(){this.dsearch("")},computed:{valuePropPassed(){return"value"in this.$attrs},selectedValue:{get(){return this.valuePropPassed?this.$attrs.value:this.modelValue},set(e){this.query="",this.$emit(this.valuePropPassed?"change":"update:modelValue",e)}},filteredOptions(){if(this.resourceOptions){let e=this.$resources.search.data||[];return e.length==0?[]:this.resourceOptions.responseMap(e)}else return this.query?this.options.filter(e=>[e.label,e.value].some(c=>(c||"").toLowerCase().includes(this.query.toLowerCase()))):this.options}},methods:{displayValue(e){return typeof e=="string"?e:e?.label},dsearch:ge(function(e){this.search(e)},300),search(e){this.searchable&&this.$resources.search.fetch(this.resourceOptions.inputMap(e))}},watch:{resourceOptions(e){e&&this.$nextTick(()=>{this.search("")})}},resources:{search(){if(this.resourceOptions)return{url:this.resourceOptions.url}}}},qe={class:"w-full"},Ue={key:0,class:"text-base line-clamp-1"},Ke={key:1,class:"text-base text-gray-500"},He={class:"flex items-st items-stretch space-x-1.5 sticky top-0 pt-1.5 mb-1.5 bg-white"},ze={key:1},Ge=j("li",{class:"px-2.5 py-1.5 rounded-md text-base text-gray-600"}," No results found ",-1);function Je(e,f,c,V,t,o){const d=D("CustomIcons"),O=D("ComboboxButton"),u=D("ComboboxInput"),b=D("Button"),m=D("Tooltip"),y=D("ComboboxOption"),R=D("ComboboxOptions"),w=D("Popover"),T=D("Combobox");return F(),z(T,{modelValue:o.selectedValue,"onUpdate:modelValue":f[2]||(f[2]=a=>o.selectedValue=a),nullable:""},{default:N(({open:a})=>[K(w,{class:"w-full"},{target:N(({open:l})=>[j("div",qe,[K(O,{class:"w-full",onClick:()=>{c.searchable&&l()}},{default:N(()=>[Z(e.$slots,"input-holder",{open:e.foo,selectedValue:o.selectedValue},()=>[j("div",{class:G(["h-[28px] flex items-center justify-between w-full py-1.5 pl-3 pr-2 rounded-md bg-gray-100",{"rounded-b-none":a}])},[Z(e.$slots,"input",{selectedValue:o.selectedValue,placeholder:c.searchable?c.placeholder:""},()=>[o.selectedValue?(F(),J("span",Ue,Q(o.displayValue(o.selectedValue)),1)):(F(),J("span",Ke,Q(c.searchable?c.placeholder:""),1))]),c.searchable?(F(),z(d,{key:0,name:"select",class:"w-[12px] h-[12px] stroke-gray-500"})):ae("",!0)],2)])]),_:2},1032,["onClick"])])]),body:N(()=>[Oe(K(R,{class:G(["max-w-[240px] px-1.5 pb-1.5 bg-white rounded-md mt-2 border shadow-md max-h-[11rem] overflow-y-auto",c.width?`w-[${c.width}px]`:"w-[250px]"]),static:""},{default:N(()=>[j("div",He,[K(u,{class:"w-full placeholder-gray-500 form-input",type:"text",onChange:f[0]||(f[0]=l=>{t.query=l.target.value,c.resourceOptions&&o.dsearch(t.query)}),value:t.query,autocomplete:"off",placeholder:"Search by keyword"},null,8,["value"]),K(b,{icon:"x",onClick:f[1]||(f[1]=l=>o.selectedValue=null)})]),(F(!0),J(ne,null,Ce(o.filteredOptions,l=>(F(),z(y,{as:"template",key:l.value,value:l},{default:N(({active:r,selected:I})=>[j("li",{class:G(["px-2.5 py-1.5 cursor-pointer rounded-md text-base",[{"bg-gray-100":r}]])},[l.label.length>20*c.width/220?(F(),z(m,{key:0,placement:"top",text:l.label},{default:N(()=>[j("div",{class:G(["line-clamp-1",`w-[${c.width-25+"px"}]`])},Q(l.label),3)]),_:2},1032,["text"])):(F(),J("div",ze,Q(l.label),1))],2)]),_:2},1032,["value"]))),128)),o.filteredOptions?.length==0?Z(e.$slots,"no-result-found",{key:0},()=>[Ge]):ae("",!0)]),_:2},1032,["class"]),[[Se,a]])]),_:2},1024)]),_:3},8,["modelValue"])}const $e=he(Me,[["render",Je]]);export{$e as A};
