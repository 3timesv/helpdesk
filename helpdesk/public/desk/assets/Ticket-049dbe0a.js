import{_ as Z,s as J,av as Xe,r as x,o as d,d as h,b as c,i as p,t as S,m as T,F as N,e as L,p as O,h as W,c as $,I as lt,w as j,f as Oe,v as Ae,aw as Qe,k as te,a as qe,x as Re,at as Ne,D as et,H as tt,u as dt,j as ee,q as H}from"./index-d9377e3a.js";import{A as ut}from"./Avatar-166461f8.js";import{C as ht}from"./Card-a4b42a0d.js";import{D as mt}from"./Dropdown-e0c50cd3.js";import{E as pt}from"./ErrorMessage-e4ff6432.js";import{F as ft}from"./FileUploader-997fc331.js";import{T as st,a as _t}from"./TextEditor-b1ee2b34.js";import{L as vt}from"./LoadingText-f736f9e5.js";import{C as He}from"./CustomAvatar-eaa7b5a6.js";import{C as Y}from"./CustomIcons-60888788.js";import{A as gt}from"./Autocomplete-c752a27e.js";import{T as yt,C as xt}from"./CustomerSatisfactionFeedback-1d6ae62c.js";import{T as kt}from"./TicketStatus-1f4b539e.js";import"./use-tracked-pointer-4b3ac621.js";import"./use-resolve-button-type-390b11ae.js";import"./use-controllable-93c8440b.js";var E;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function s(a){throw new Error}t.assertNever=s,t.arrayToEnum=a=>{const r={};for(const i of a)r[i]=i;return r},t.getValidEnumValues=a=>{const r=t.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),i={};for(const o of r)i[o]=a[o];return t.objectValues(i)},t.objectValues=a=>t.objectKeys(a).map(function(r){return a[r]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const r=[];for(const i in a)Object.prototype.hasOwnProperty.call(a,i)&&r.push(i);return r},t.find=(a,r)=>{for(const i of a)if(r(i))return i},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,r=" | "){return a.map(i=>typeof i=="string"?`'${i}'`:i).join(r)}t.joinValues=n,t.jsonStringifyReplacer=(a,r)=>typeof r=="bigint"?r.toString():r})(E||(E={}));var Ke;(function(t){t.mergeShapes=(e,s)=>({...e,...s})})(Ke||(Ke={}));const f=E.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),X=t=>{switch(typeof t){case"undefined":return f.undefined;case"string":return f.string;case"number":return isNaN(t)?f.nan:f.number;case"boolean":return f.boolean;case"function":return f.function;case"bigint":return f.bigint;case"symbol":return f.symbol;case"object":return Array.isArray(t)?f.array:t===null?f.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?f.promise:typeof Map<"u"&&t instanceof Map?f.map:typeof Set<"u"&&t instanceof Set?f.set:typeof Date<"u"&&t instanceof Date?f.date:f.object;default:return f.unknown}},u=E.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class P extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const s=e||function(r){return r.message},n={_errors:[]},a=r=>{for(const i of r.issues)if(i.code==="invalid_union")i.unionErrors.map(a);else if(i.code==="invalid_return_type")a(i.returnTypeError);else if(i.code==="invalid_arguments")a(i.argumentsError);else if(i.path.length===0)n._errors.push(s(i));else{let o=n,m=0;for(;m<i.path.length;){const l=i.path[m];m===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(s(i))):o[l]=o[l]||{_errors:[]},o=o[l],m++}}};return a(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,E.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=s=>s.message){const s={},n=[];for(const a of this.issues)a.path.length>0?(s[a.path[0]]=s[a.path[0]]||[],s[a.path[0]].push(e(a))):n.push(e(a));return{formErrors:n,fieldErrors:s}}get formErrors(){return this.flatten()}}P.create=t=>new P(t);const he=(t,e)=>{let s;switch(t.code){case u.invalid_type:t.received===f.undefined?s="Required":s=`Expected ${t.expected}, received ${t.received}`;break;case u.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(t.expected,E.jsonStringifyReplacer)}`;break;case u.unrecognized_keys:s=`Unrecognized key(s) in object: ${E.joinValues(t.keys,", ")}`;break;case u.invalid_union:s="Invalid input";break;case u.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${E.joinValues(t.options)}`;break;case u.invalid_enum_value:s=`Invalid enum value. Expected ${E.joinValues(t.options)}, received '${t.received}'`;break;case u.invalid_arguments:s="Invalid function arguments";break;case u.invalid_return_type:s="Invalid function return type";break;case u.invalid_date:s="Invalid date";break;case u.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(s=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?s=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?s=`Invalid input: must end with "${t.validation.endsWith}"`:E.assertNever(t.validation):t.validation!=="regex"?s=`Invalid ${t.validation}`:s="Invalid";break;case u.too_small:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:s="Invalid input";break;case u.too_big:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?s=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:s="Invalid input";break;case u.custom:s="Invalid input";break;case u.invalid_intersection_types:s="Intersection results could not be merged";break;case u.not_multiple_of:s=`Number must be a multiple of ${t.multipleOf}`;break;case u.not_finite:s="Number must be finite";break;default:s=e.defaultError,E.assertNever(t)}return{message:s}};let bt=he;function Le(){return bt}const je=t=>{const{data:e,path:s,errorMaps:n,issueData:a}=t,r=[...s,...a.path||[]],i={...a,path:r};let o="";const m=n.filter(l=>!!l).slice().reverse();for(const l of m)o=l(i,{data:e,defaultError:o}).message;return{...a,path:r,message:a.message||o}};function _(t,e){const s=je({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Le(),he].filter(n=>!!n)});t.common.issues.push(s)}class D{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,s){const n=[];for(const a of s){if(a.status==="aborted")return w;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,s){const n=[];for(const a of s)n.push({key:await a.key,value:await a.value});return D.mergeObjectSync(e,n)}static mergeObjectSync(e,s){const n={};for(const a of s){const{key:r,value:i}=a;if(r.status==="aborted"||i.status==="aborted")return w;r.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),(typeof i.value<"u"||a.alwaysSet)&&(n[r.value]=i.value)}return{status:e.value,value:n}}}const w=Object.freeze({status:"aborted"}),wt=t=>({status:"dirty",value:t}),M=t=>({status:"valid",value:t}),Je=t=>t.status==="aborted",Ye=t=>t.status==="dirty",De=t=>t.status==="valid",Me=t=>typeof Promise<"u"&&t instanceof Promise;var y;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(y||(y={}));class B{constructor(e,s,n,a){this._cachedPath=[],this.parent=e,this.data=s,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ge=(t,e)=>{if(De(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new P(t.common.issues);return this._error=s,this._error}}};function C(t){if(!t)return{};const{errorMap:e,invalid_type_error:s,required_error:n,description:a}=t;if(e&&(s||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(i,o)=>i.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:n??o.defaultError}:{message:s??o.defaultError},description:a}}class I{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return X(e.data)}_getOrReturnCtx(e,s){return s||{common:e.parent.common,data:e.data,parsedType:X(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new D,ctx:{common:e.parent.common,data:e.data,parsedType:X(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const s=this._parse(e);if(Me(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(e){const s=this._parse(e);return Promise.resolve(s)}parse(e,s){const n=this.safeParse(e,s);if(n.success)return n.data;throw n.error}safeParse(e,s){var n;const a={common:{issues:[],async:(n=s?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:s?.errorMap},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:X(e)},r=this._parseSync({data:e,path:a.path,parent:a});return Ge(a,r)}async parseAsync(e,s){const n=await this.safeParseAsync(e,s);if(n.success)return n.data;throw n.error}async safeParseAsync(e,s){const n={common:{issues:[],contextualErrorMap:s?.errorMap,async:!0},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:X(e)},a=this._parse({data:e,path:n.path,parent:n}),r=await(Me(a)?a:Promise.resolve(a));return Ge(n,r)}refine(e,s){const n=a=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(a):s;return this._refinement((a,r)=>{const i=e(a),o=()=>r.addIssue({code:u.custom,...n(a)});return typeof Promise<"u"&&i instanceof Promise?i.then(m=>m?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,s){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof s=="function"?s(n,a):s),!1))}_refinement(e){return new z({schema:this,typeName:b.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return q.create(this,this._def)}nullable(){return oe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return V.create(this,this._def)}promise(){return de.create(this,this._def)}or(e){return fe.create([this,e],this._def)}and(e){return _e.create(this,e,this._def)}transform(e){return new z({...C(this._def),schema:this,typeName:b.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const s=typeof e=="function"?e:()=>e;return new ke({...C(this._def),innerType:this,defaultValue:s,typeName:b.ZodDefault})}brand(){return new Dt({typeName:b.ZodBranded,type:this,...C(this._def)})}catch(e){const s=typeof e=="function"?e:()=>e;return new Ue({...C(this._def),innerType:this,catchValue:s,typeName:b.ZodCatch})}describe(e){const s=this.constructor;return new s({...this._def,description:e})}pipe(e){return be.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Ct=/^c[^\s-]{8,}$/i,Tt=/^[a-z][a-z0-9]*$/,It=/[0-9A-HJKMNP-TV-Z]{26}/,St=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Et=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,Ot=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,At=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Rt=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Nt=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Lt(t,e){return!!((e==="v4"||!e)&&At.test(t)||(e==="v6"||!e)&&Rt.test(t))}class F extends I{constructor(){super(...arguments),this._regex=(e,s,n)=>this.refinement(a=>e.test(a),{validation:s,code:u.invalid_string,...y.errToObj(n)}),this.nonempty=e=>this.min(1,y.errToObj(e)),this.trim=()=>new F({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new F({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new F({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==f.string){const r=this._getOrReturnCtx(e);return _(r,{code:u.invalid_type,expected:f.string,received:r.parsedType}),w}const n=new D;let a;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(a=this._getOrReturnCtx(e,a),_(a,{code:u.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="max")e.data.length>r.value&&(a=this._getOrReturnCtx(e,a),_(a,{code:u.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="length"){const i=e.data.length>r.value,o=e.data.length<r.value;(i||o)&&(a=this._getOrReturnCtx(e,a),i?_(a,{code:u.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):o&&_(a,{code:u.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),n.dirty())}else if(r.kind==="email")Et.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"email",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="emoji")Ot.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"emoji",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="uuid")St.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"uuid",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid")Ct.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"cuid",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid2")Tt.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"cuid2",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="ulid")It.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"ulid",code:u.invalid_string,message:r.message}),n.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),_(a,{validation:"url",code:u.invalid_string,message:r.message}),n.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"regex",code:u.invalid_string,message:r.message}),n.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(a=this._getOrReturnCtx(e,a),_(a,{code:u.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),n.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(a=this._getOrReturnCtx(e,a),_(a,{code:u.invalid_string,validation:{startsWith:r.value},message:r.message}),n.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(a=this._getOrReturnCtx(e,a),_(a,{code:u.invalid_string,validation:{endsWith:r.value},message:r.message}),n.dirty()):r.kind==="datetime"?Nt(r).test(e.data)||(a=this._getOrReturnCtx(e,a),_(a,{code:u.invalid_string,validation:"datetime",message:r.message}),n.dirty()):r.kind==="ip"?Lt(e.data,r.version)||(a=this._getOrReturnCtx(e,a),_(a,{validation:"ip",code:u.invalid_string,message:r.message}),n.dirty()):E.assertNever(r);return{status:n.value,value:e.data}}_addCheck(e){return new F({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...y.errToObj(e)})}url(e){return this._addCheck({kind:"url",...y.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...y.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...y.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...y.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...y.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...y.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...y.errToObj(e)})}datetime(e){var s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(s=e?.offset)!==null&&s!==void 0?s:!1,...y.errToObj(e?.message)})}regex(e,s){return this._addCheck({kind:"regex",regex:e,...y.errToObj(s)})}includes(e,s){return this._addCheck({kind:"includes",value:e,position:s?.position,...y.errToObj(s?.message)})}startsWith(e,s){return this._addCheck({kind:"startsWith",value:e,...y.errToObj(s)})}endsWith(e,s){return this._addCheck({kind:"endsWith",value:e,...y.errToObj(s)})}min(e,s){return this._addCheck({kind:"min",value:e,...y.errToObj(s)})}max(e,s){return this._addCheck({kind:"max",value:e,...y.errToObj(s)})}length(e,s){return this._addCheck({kind:"length",value:e,...y.errToObj(s)})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxLength(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}}F.create=t=>{var e;return new F({checks:[],typeName:b.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...C(t)})};function jt(t,e){const s=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=s>n?s:n,r=parseInt(t.toFixed(a).replace(".","")),i=parseInt(e.toFixed(a).replace(".",""));return r%i/Math.pow(10,a)}class re extends I{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==f.number){const r=this._getOrReturnCtx(e);return _(r,{code:u.invalid_type,expected:f.number,received:r.parsedType}),w}let n;const a=new D;for(const r of this._def.checks)r.kind==="int"?E.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),_(n,{code:u.invalid_type,expected:"integer",received:"float",message:r.message}),a.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty()):r.kind==="multipleOf"?jt(e.data,r.value)!==0&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),_(n,{code:u.not_finite,message:r.message}),a.dirty()):E.assertNever(r);return{status:a.value,value:e.data}}gte(e,s){return this.setLimit("min",e,!0,y.toString(s))}gt(e,s){return this.setLimit("min",e,!1,y.toString(s))}lte(e,s){return this.setLimit("max",e,!0,y.toString(s))}lt(e,s){return this.setLimit("max",e,!1,y.toString(s))}setLimit(e,s,n,a){return new re({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:n,message:y.toString(a)}]})}_addCheck(e){return new re({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:y.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:y.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:y.toString(s)})}finite(e){return this._addCheck({kind:"finite",message:y.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:y.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:y.toString(e)})}get minValue(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&E.isInteger(e.value))}get isFinite(){let e=null,s=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(s===null||n.value>s)&&(s=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(s)&&Number.isFinite(e)}}re.create=t=>new re({checks:[],typeName:b.ZodNumber,coerce:t?.coerce||!1,...C(t)});class ae extends I{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==f.bigint){const r=this._getOrReturnCtx(e);return _(r,{code:u.invalid_type,expected:f.bigint,received:r.parsedType}),w}let n;const a=new D;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),_(n,{code:u.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):E.assertNever(r);return{status:a.value,value:e.data}}gte(e,s){return this.setLimit("min",e,!0,y.toString(s))}gt(e,s){return this.setLimit("min",e,!1,y.toString(s))}lte(e,s){return this.setLimit("max",e,!0,y.toString(s))}lt(e,s){return this.setLimit("max",e,!1,y.toString(s))}setLimit(e,s,n,a){return new ae({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:n,message:y.toString(a)}]})}_addCheck(e){return new ae({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:y.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:y.toString(s)})}get minValue(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}}ae.create=t=>{var e;return new ae({checks:[],typeName:b.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...C(t)})};class $e extends I{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==f.boolean){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.boolean,received:n.parsedType}),w}return M(e.data)}}$e.create=t=>new $e({typeName:b.ZodBoolean,coerce:t?.coerce||!1,...C(t)});class le extends I{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==f.date){const r=this._getOrReturnCtx(e);return _(r,{code:u.invalid_type,expected:f.date,received:r.parsedType}),w}if(isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return _(r,{code:u.invalid_date}),w}const n=new D;let a;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(a=this._getOrReturnCtx(e,a),_(a,{code:u.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(a=this._getOrReturnCtx(e,a),_(a,{code:u.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):E.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new le({...this._def,checks:[...this._def.checks,e]})}min(e,s){return this._addCheck({kind:"min",value:e.getTime(),message:y.toString(s)})}max(e,s){return this._addCheck({kind:"max",value:e.getTime(),message:y.toString(s)})}get minDate(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e!=null?new Date(e):null}}le.create=t=>new le({checks:[],coerce:t?.coerce||!1,typeName:b.ZodDate,...C(t)});class Ze extends I{_parse(e){if(this._getType(e)!==f.symbol){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.symbol,received:n.parsedType}),w}return M(e.data)}}Ze.create=t=>new Ze({typeName:b.ZodSymbol,...C(t)});class me extends I{_parse(e){if(this._getType(e)!==f.undefined){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.undefined,received:n.parsedType}),w}return M(e.data)}}me.create=t=>new me({typeName:b.ZodUndefined,...C(t)});class pe extends I{_parse(e){if(this._getType(e)!==f.null){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.null,received:n.parsedType}),w}return M(e.data)}}pe.create=t=>new pe({typeName:b.ZodNull,...C(t)});class Pe extends I{constructor(){super(...arguments),this._any=!0}_parse(e){return M(e.data)}}Pe.create=t=>new Pe({typeName:b.ZodAny,...C(t)});class ne extends I{constructor(){super(...arguments),this._unknown=!0}_parse(e){return M(e.data)}}ne.create=t=>new ne({typeName:b.ZodUnknown,...C(t)});class K extends I{_parse(e){const s=this._getOrReturnCtx(e);return _(s,{code:u.invalid_type,expected:f.never,received:s.parsedType}),w}}K.create=t=>new K({typeName:b.ZodNever,...C(t)});class Ve extends I{_parse(e){if(this._getType(e)!==f.undefined){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.void,received:n.parsedType}),w}return M(e.data)}}Ve.create=t=>new Ve({typeName:b.ZodVoid,...C(t)});class V extends I{_parse(e){const{ctx:s,status:n}=this._processInputParams(e),a=this._def;if(s.parsedType!==f.array)return _(s,{code:u.invalid_type,expected:f.array,received:s.parsedType}),w;if(a.exactLength!==null){const i=s.data.length>a.exactLength.value,o=s.data.length<a.exactLength.value;(i||o)&&(_(s,{code:i?u.too_big:u.too_small,minimum:o?a.exactLength.value:void 0,maximum:i?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&s.data.length<a.minLength.value&&(_(s,{code:u.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&s.data.length>a.maxLength.value&&(_(s,{code:u.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),s.common.async)return Promise.all([...s.data].map((i,o)=>a.type._parseAsync(new B(s,i,s.path,o)))).then(i=>D.mergeArray(n,i));const r=[...s.data].map((i,o)=>a.type._parseSync(new B(s,i,s.path,o)));return D.mergeArray(n,r)}get element(){return this._def.type}min(e,s){return new V({...this._def,minLength:{value:e,message:y.toString(s)}})}max(e,s){return new V({...this._def,maxLength:{value:e,message:y.toString(s)}})}length(e,s){return new V({...this._def,exactLength:{value:e,message:y.toString(s)}})}nonempty(e){return this.min(1,e)}}V.create=(t,e)=>new V({type:t,minLength:null,maxLength:null,exactLength:null,typeName:b.ZodArray,...C(e)});function se(t){if(t instanceof A){const e={};for(const s in t.shape){const n=t.shape[s];e[s]=q.create(se(n))}return new A({...t._def,shape:()=>e})}else return t instanceof V?new V({...t._def,type:se(t.element)}):t instanceof q?q.create(se(t.unwrap())):t instanceof oe?oe.create(se(t.unwrap())):t instanceof U?U.create(t.items.map(e=>se(e))):t}class A extends I{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),s=E.objectKeys(e);return this._cached={shape:e,keys:s}}_parse(e){if(this._getType(e)!==f.object){const l=this._getOrReturnCtx(e);return _(l,{code:u.invalid_type,expected:f.object,received:l.parsedType}),w}const{status:n,ctx:a}=this._processInputParams(e),{shape:r,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof K&&this._def.unknownKeys==="strip"))for(const l in a.data)i.includes(l)||o.push(l);const m=[];for(const l of i){const g=r[l],R=a.data[l];m.push({key:{status:"valid",value:l},value:g._parse(new B(a,R,a.path,l)),alwaysSet:l in a.data})}if(this._def.catchall instanceof K){const l=this._def.unknownKeys;if(l==="passthrough")for(const g of o)m.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(l==="strict")o.length>0&&(_(a,{code:u.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const g of o){const R=a.data[g];m.push({key:{status:"valid",value:g},value:l._parse(new B(a,R,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const l=[];for(const g of m){const R=await g.key;l.push({key:R,value:await g.value,alwaysSet:g.alwaysSet})}return l}).then(l=>D.mergeObjectSync(n,l)):D.mergeObjectSync(n,m)}get shape(){return this._def.shape()}strict(e){return y.errToObj,new A({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(s,n)=>{var a,r,i,o;const m=(i=(r=(a=this._def).errorMap)===null||r===void 0?void 0:r.call(a,s,n).message)!==null&&i!==void 0?i:n.defaultError;return s.code==="unrecognized_keys"?{message:(o=y.errToObj(e).message)!==null&&o!==void 0?o:m}:{message:m}}}:{}})}strip(){return new A({...this._def,unknownKeys:"strip"})}passthrough(){return new A({...this._def,unknownKeys:"passthrough"})}extend(e){return new A({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new A({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:b.ZodObject})}setKey(e,s){return this.augment({[e]:s})}catchall(e){return new A({...this._def,catchall:e})}pick(e){const s={};return E.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(s[n]=this.shape[n])}),new A({...this._def,shape:()=>s})}omit(e){const s={};return E.objectKeys(this.shape).forEach(n=>{e[n]||(s[n]=this.shape[n])}),new A({...this._def,shape:()=>s})}deepPartial(){return se(this)}partial(e){const s={};return E.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];e&&!e[n]?s[n]=a:s[n]=a.optional()}),new A({...this._def,shape:()=>s})}required(e){const s={};return E.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])s[n]=this.shape[n];else{let r=this.shape[n];for(;r instanceof q;)r=r._def.innerType;s[n]=r}}),new A({...this._def,shape:()=>s})}keyof(){return nt(E.objectKeys(this.shape))}}A.create=(t,e)=>new A({shape:()=>t,unknownKeys:"strip",catchall:K.create(),typeName:b.ZodObject,...C(e)});A.strictCreate=(t,e)=>new A({shape:()=>t,unknownKeys:"strict",catchall:K.create(),typeName:b.ZodObject,...C(e)});A.lazycreate=(t,e)=>new A({shape:t,unknownKeys:"strip",catchall:K.create(),typeName:b.ZodObject,...C(e)});class fe extends I{_parse(e){const{ctx:s}=this._processInputParams(e),n=this._def.options;function a(r){for(const o of r)if(o.result.status==="valid")return o.result;for(const o of r)if(o.result.status==="dirty")return s.common.issues.push(...o.ctx.common.issues),o.result;const i=r.map(o=>new P(o.ctx.common.issues));return _(s,{code:u.invalid_union,unionErrors:i}),w}if(s.common.async)return Promise.all(n.map(async r=>{const i={...s,common:{...s.common,issues:[]},parent:null};return{result:await r._parseAsync({data:s.data,path:s.path,parent:i}),ctx:i}})).then(a);{let r;const i=[];for(const m of n){const l={...s,common:{...s.common,issues:[]},parent:null},g=m._parseSync({data:s.data,path:s.path,parent:l});if(g.status==="valid")return g;g.status==="dirty"&&!r&&(r={result:g,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(r)return s.common.issues.push(...r.ctx.common.issues),r.result;const o=i.map(m=>new P(m));return _(s,{code:u.invalid_union,unionErrors:o}),w}}get options(){return this._def.options}}fe.create=(t,e)=>new fe({options:t,typeName:b.ZodUnion,...C(e)});const ue=t=>t instanceof ge?ue(t.schema):t instanceof z?ue(t.innerType()):t instanceof ye?[t.value]:t instanceof Q?t.options:t instanceof xe?Object.keys(t.enum):t instanceof ke?ue(t._def.innerType):t instanceof me?[void 0]:t instanceof pe?[null]:null;class We extends I{_parse(e){const{ctx:s}=this._processInputParams(e);if(s.parsedType!==f.object)return _(s,{code:u.invalid_type,expected:f.object,received:s.parsedType}),w;const n=this.discriminator,a=s.data[n],r=this.optionsMap.get(a);return r?s.common.async?r._parseAsync({data:s.data,path:s.path,parent:s}):r._parseSync({data:s.data,path:s.path,parent:s}):(_(s,{code:u.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),w)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,s,n){const a=new Map;for(const r of s){const i=ue(r.shape[e]);if(!i)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(a.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);a.set(o,r)}}return new We({typeName:b.ZodDiscriminatedUnion,discriminator:e,options:s,optionsMap:a,...C(n)})}}function Be(t,e){const s=X(t),n=X(e);if(t===e)return{valid:!0,data:t};if(s===f.object&&n===f.object){const a=E.objectKeys(e),r=E.objectKeys(t).filter(o=>a.indexOf(o)!==-1),i={...t,...e};for(const o of r){const m=Be(t[o],e[o]);if(!m.valid)return{valid:!1};i[o]=m.data}return{valid:!0,data:i}}else if(s===f.array&&n===f.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let r=0;r<t.length;r++){const i=t[r],o=e[r],m=Be(i,o);if(!m.valid)return{valid:!1};a.push(m.data)}return{valid:!0,data:a}}else return s===f.date&&n===f.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class _e extends I{_parse(e){const{status:s,ctx:n}=this._processInputParams(e),a=(r,i)=>{if(Je(r)||Je(i))return w;const o=Be(r.value,i.value);return o.valid?((Ye(r)||Ye(i))&&s.dirty(),{status:s.value,value:o.data}):(_(n,{code:u.invalid_intersection_types}),w)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([r,i])=>a(r,i)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}_e.create=(t,e,s)=>new _e({left:t,right:e,typeName:b.ZodIntersection,...C(s)});class U extends I{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==f.array)return _(n,{code:u.invalid_type,expected:f.array,received:n.parsedType}),w;if(n.data.length<this._def.items.length)return _(n,{code:u.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),w;!this._def.rest&&n.data.length>this._def.items.length&&(_(n,{code:u.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const r=[...n.data].map((i,o)=>{const m=this._def.items[o]||this._def.rest;return m?m._parse(new B(n,i,n.path,o)):null}).filter(i=>!!i);return n.common.async?Promise.all(r).then(i=>D.mergeArray(s,i)):D.mergeArray(s,r)}get items(){return this._def.items}rest(e){return new U({...this._def,rest:e})}}U.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new U({items:t,typeName:b.ZodTuple,rest:null,...C(e)})};class ve extends I{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==f.object)return _(n,{code:u.invalid_type,expected:f.object,received:n.parsedType}),w;const a=[],r=this._def.keyType,i=this._def.valueType;for(const o in n.data)a.push({key:r._parse(new B(n,o,n.path,o)),value:i._parse(new B(n,n.data[o],n.path,o))});return n.common.async?D.mergeObjectAsync(s,a):D.mergeObjectSync(s,a)}get element(){return this._def.valueType}static create(e,s,n){return s instanceof I?new ve({keyType:e,valueType:s,typeName:b.ZodRecord,...C(n)}):new ve({keyType:F.create(),valueType:e,typeName:b.ZodRecord,...C(s)})}}class Fe extends I{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==f.map)return _(n,{code:u.invalid_type,expected:f.map,received:n.parsedType}),w;const a=this._def.keyType,r=this._def.valueType,i=[...n.data.entries()].map(([o,m],l)=>({key:a._parse(new B(n,o,n.path,[l,"key"])),value:r._parse(new B(n,m,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const m of i){const l=await m.key,g=await m.value;if(l.status==="aborted"||g.status==="aborted")return w;(l.status==="dirty"||g.status==="dirty")&&s.dirty(),o.set(l.value,g.value)}return{status:s.value,value:o}})}else{const o=new Map;for(const m of i){const l=m.key,g=m.value;if(l.status==="aborted"||g.status==="aborted")return w;(l.status==="dirty"||g.status==="dirty")&&s.dirty(),o.set(l.value,g.value)}return{status:s.value,value:o}}}}Fe.create=(t,e,s)=>new Fe({valueType:e,keyType:t,typeName:b.ZodMap,...C(s)});class ie extends I{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==f.set)return _(n,{code:u.invalid_type,expected:f.set,received:n.parsedType}),w;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(_(n,{code:u.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),s.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(_(n,{code:u.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),s.dirty());const r=this._def.valueType;function i(m){const l=new Set;for(const g of m){if(g.status==="aborted")return w;g.status==="dirty"&&s.dirty(),l.add(g.value)}return{status:s.value,value:l}}const o=[...n.data.values()].map((m,l)=>r._parse(new B(n,m,n.path,l)));return n.common.async?Promise.all(o).then(m=>i(m)):i(o)}min(e,s){return new ie({...this._def,minSize:{value:e,message:y.toString(s)}})}max(e,s){return new ie({...this._def,maxSize:{value:e,message:y.toString(s)}})}size(e,s){return this.min(e,s).max(e,s)}nonempty(e){return this.min(1,e)}}ie.create=(t,e)=>new ie({valueType:t,minSize:null,maxSize:null,typeName:b.ZodSet,...C(e)});class ce extends I{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:s}=this._processInputParams(e);if(s.parsedType!==f.function)return _(s,{code:u.invalid_type,expected:f.function,received:s.parsedType}),w;function n(o,m){return je({data:o,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,Le(),he].filter(l=>!!l),issueData:{code:u.invalid_arguments,argumentsError:m}})}function a(o,m){return je({data:o,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,Le(),he].filter(l=>!!l),issueData:{code:u.invalid_return_type,returnTypeError:m}})}const r={errorMap:s.common.contextualErrorMap},i=s.data;return this._def.returns instanceof de?M(async(...o)=>{const m=new P([]),l=await this._def.args.parseAsync(o,r).catch(v=>{throw m.addIssue(n(o,v)),m}),g=await i(...l);return await this._def.returns._def.type.parseAsync(g,r).catch(v=>{throw m.addIssue(a(g,v)),m})}):M((...o)=>{const m=this._def.args.safeParse(o,r);if(!m.success)throw new P([n(o,m.error)]);const l=i(...m.data),g=this._def.returns.safeParse(l,r);if(!g.success)throw new P([a(l,g.error)]);return g.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ce({...this._def,args:U.create(e).rest(ne.create())})}returns(e){return new ce({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,s,n){return new ce({args:e||U.create([]).rest(ne.create()),returns:s||ne.create(),typeName:b.ZodFunction,...C(n)})}}class ge extends I{get schema(){return this._def.getter()}_parse(e){const{ctx:s}=this._processInputParams(e);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}ge.create=(t,e)=>new ge({getter:t,typeName:b.ZodLazy,...C(e)});class ye extends I{_parse(e){if(e.data!==this._def.value){const s=this._getOrReturnCtx(e);return _(s,{received:s.data,code:u.invalid_literal,expected:this._def.value}),w}return{status:"valid",value:e.data}}get value(){return this._def.value}}ye.create=(t,e)=>new ye({value:t,typeName:b.ZodLiteral,...C(e)});function nt(t,e){return new Q({values:t,typeName:b.ZodEnum,...C(e)})}class Q extends I{_parse(e){if(typeof e.data!="string"){const s=this._getOrReturnCtx(e),n=this._def.values;return _(s,{expected:E.joinValues(n),received:s.parsedType,code:u.invalid_type}),w}if(this._def.values.indexOf(e.data)===-1){const s=this._getOrReturnCtx(e),n=this._def.values;return _(s,{received:s.data,code:u.invalid_enum_value,options:n}),w}return M(e.data)}get options(){return this._def.values}get enum(){const e={};for(const s of this._def.values)e[s]=s;return e}get Values(){const e={};for(const s of this._def.values)e[s]=s;return e}get Enum(){const e={};for(const s of this._def.values)e[s]=s;return e}extract(e){return Q.create(e)}exclude(e){return Q.create(this.options.filter(s=>!e.includes(s)))}}Q.create=nt;class xe extends I{_parse(e){const s=E.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==f.string&&n.parsedType!==f.number){const a=E.objectValues(s);return _(n,{expected:E.joinValues(a),received:n.parsedType,code:u.invalid_type}),w}if(s.indexOf(e.data)===-1){const a=E.objectValues(s);return _(n,{received:n.data,code:u.invalid_enum_value,options:a}),w}return M(e.data)}get enum(){return this._def.values}}xe.create=(t,e)=>new xe({values:t,typeName:b.ZodNativeEnum,...C(e)});class de extends I{unwrap(){return this._def.type}_parse(e){const{ctx:s}=this._processInputParams(e);if(s.parsedType!==f.promise&&s.common.async===!1)return _(s,{code:u.invalid_type,expected:f.promise,received:s.parsedType}),w;const n=s.parsedType===f.promise?s.data:Promise.resolve(s.data);return M(n.then(a=>this._def.type.parseAsync(a,{path:s.path,errorMap:s.common.contextualErrorMap})))}}de.create=(t,e)=>new de({type:t,typeName:b.ZodPromise,...C(e)});class z extends I{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===b.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:s,ctx:n}=this._processInputParams(e),a=this._def.effect||null;if(a.type==="preprocess"){const i=a.transform(n.data);return n.common.async?Promise.resolve(i).then(o=>this._def.schema._parseAsync({data:o,path:n.path,parent:n})):this._def.schema._parseSync({data:i,path:n.path,parent:n})}const r={addIssue:i=>{_(n,i),i.fatal?s.abort():s.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),a.type==="refinement"){const i=o=>{const m=a.refinement(o,r);if(n.common.async)return Promise.resolve(m);if(m instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?w:(o.status==="dirty"&&s.dirty(),i(o.value),{status:s.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?w:(o.status==="dirty"&&s.dirty(),i(o.value).then(()=>({status:s.value,value:o.value}))))}if(a.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!De(i))return i;const o=a.transform(i.value,r);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>De(i)?Promise.resolve(a.transform(i.value,r)).then(o=>({status:s.value,value:o})):i);E.assertNever(a)}}z.create=(t,e,s)=>new z({schema:t,typeName:b.ZodEffects,effect:e,...C(s)});z.createWithPreprocess=(t,e,s)=>new z({schema:e,effect:{type:"preprocess",transform:t},typeName:b.ZodEffects,...C(s)});class q extends I{_parse(e){return this._getType(e)===f.undefined?M(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}q.create=(t,e)=>new q({innerType:t,typeName:b.ZodOptional,...C(e)});class oe extends I{_parse(e){return this._getType(e)===f.null?M(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}oe.create=(t,e)=>new oe({innerType:t,typeName:b.ZodNullable,...C(e)});class ke extends I{_parse(e){const{ctx:s}=this._processInputParams(e);let n=s.data;return s.parsedType===f.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}ke.create=(t,e)=>new ke({innerType:t,typeName:b.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...C(e)});class Ue extends I{_parse(e){const{ctx:s}=this._processInputParams(e),n={...s,common:{...s.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Me(a)?a.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new P(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new P(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ue.create=(t,e)=>new Ue({innerType:t,typeName:b.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...C(e)});class ze extends I{_parse(e){if(this._getType(e)!==f.nan){const n=this._getOrReturnCtx(e);return _(n,{code:u.invalid_type,expected:f.nan,received:n.parsedType}),w}return{status:"valid",value:e.data}}}ze.create=t=>new ze({typeName:b.ZodNaN,...C(t)});class Dt extends I{_parse(e){const{ctx:s}=this._processInputParams(e),n=s.data;return this._def.type._parse({data:n,path:s.path,parent:s})}unwrap(){return this._def.type}}class be extends I{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?w:r.status==="dirty"?(s.dirty(),wt(r.value)):this._def.out._parseAsync({data:r.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?w:a.status==="dirty"?(s.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(e,s){return new be({in:e,out:s,typeName:b.ZodPipeline})}}A.lazycreate;var b;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline"})(b||(b={}));const Mt=F.create;re.create;ze.create;ae.create;$e.create;le.create;Ze.create;me.create;pe.create;Pe.create;ne.create;K.create;Ve.create;V.create;A.create;A.strictCreate;fe.create;We.create;_e.create;U.create;ve.create;Fe.create;ie.create;ce.create;ge.create;ye.create;Q.create;xe.create;de.create;z.create;q.create;oe.create;z.createWithPreprocess;be.create;const $t={name:"ConversationCard",props:["comment"],components:{FeatherIcon:J,TextEditor:st,CustomAvatar:He},computed:{cleanedMessage(){return this.comment?.content?Xe(this.comment.content):""},user(){return this.$resources.user.data||null}},resources:{user(){return{url:"frappe.client.get",params:{doctype:"User",name:this.comment?.commented_by,fields:["*"]},auto:!0}}}},Zt={key:0,class:"flex flex-col my-[16px] bg-[#FDF9F2] p-[10px] rounded-[6px]"},Pt={class:"flex flex-row items-center justify-between"},Vt={key:0,class:"flex flex-row items-center space-x-[8px]"},Bt={class:"flex flex-row space-x-1 items-center text-[13px]"},Ft={class:"truncate font-medium max-w-[200px]"},Ut=c("div",{class:"font-normal text-gray-900"},"added a comment",-1),zt={class:"text-gray-500 font-normal text-[12px]"},Ht={class:"pl-[32px] pt-[6px]"},Wt={class:"flex flex-col"};function qt(t,e,s,n,a,r){const i=x("CustomAvatar"),o=x("TextEditor");return s.comment?(d(),h("div",Zt,[c("div",Pt,[r.user?(d(),h("div",Vt,[p(i,{imageURL:r.user.user_image,label:r.user.full_name,size:"sm"},null,8,["imageURL","label"]),c("div",Bt,[c("div",Ft,S(r.user.full_name),1),Ut])])):T("",!0),c("div",zt,S(t.$dayjs.longFormating(t.$dayjs(s.comment.creation).fromNow())),1)]),c("div",Ht,[c("div",Wt,[p(o,{"editor-class":"text-[13px] max-w-full",content:r.cleanedMessage,editable:!1},null,8,["content"])])])])):T("",!0)}const Kt=Z($t,[["render",qt]]);const Jt={name:"ConversationCard",props:["userName","profilePicUrl","time","message","color","attachments","cc","bcc"],components:{FeatherIcon:J,CustomAvatar:He},computed:{cleanedMessage(){return this.message?Xe(this.message):""}}},Yt={class:"flex flex-col my-[16px] px-[8px]"},Gt={class:"flex flex-row items-center justify-between"},Xt={class:"flex flex-row items-center space-x-[8px]"},Qt={class:"truncate text-[13px] max-w-[200px] text-gray-900 font-medium"},es=["title"],ts={class:"pl-8 pt-0"},ss={class:"flex flex-col"},ns={key:0,class:"flex flex-row gap-1 text-[12px] text-gray-600 font-inter"},rs={key:0},as={key:1},is=["innerHTML"],os={key:1,class:"flex flex-wrap text-base mt-[8px]"},cs=["href"],ls={class:"truncate"};function ds(t,e,s,n,a,r){const i=x("CustomAvatar"),o=x("FeatherIcon");return d(),h("div",Yt,[c("div",Gt,[c("div",Xt,[p(i,{label:s.userName,imageURL:s.profilePicUrl,size:"sm"},null,8,["label","imageURL"]),c("div",Qt,S(s.userName),1)]),c("a",{title:t.$dayjs(s.time),class:"text-gray-500 text-[12px] select-none font-normal"},S(t.$dayjs.longFormating(t.$dayjs(s.time).fromNow())),9,es)]),c("div",ts,[c("div",ss,[s.cc||s.bcc?(d(),h("div",ns,[s.cc?(d(),h("div",rs,"cc: "+S(s.cc)+",",1)):T("",!0),s.bcc?(d(),h("div",as,"bcc: "+S(s.bcc),1)):T("",!0)])):T("",!0),c("div",{class:"message text-[13px]",style:{border:"0px"},innerHTML:r.cleanedMessage},null,8,is),s.attachments.length>0?(d(),h("div",os,[(d(!0),h(N,null,L(s.attachments,m=>(d(),h("div",{key:m},[c("a",{href:m.file_url,target:"_blank",class:"py-[4px] max-w-[180px] rounded-[6px] border px-[8px] text-gray-700 font-normal text-[12px] hover:underline flex items-center space-x-[8px] border-gray-200 mr-[10px] mb-[5px]"},[p(o,{name:"paperclip",class:"h-[12px] w-[12px] shrink-0"}),c("span",ls,S(m.file_name),1)],8,cs)]))),128))])):T("",!0)])])])}const us=Z(Jt,[["render",ds],["__scopeId","data-v-eff2aaf6"]]),hs={name:"Conversations",components:{ConversationCard:us,LoadingText:vt,CommentCard:Kt},props:["ticketId","scrollToBottom","autoScroll"],setup(){const t=O({}),e=O(-1);return{userColors:t,lastColorIndex:e}},resources:{communications(){return{cache:["HD Ticket","Conversations",this.ticketId],url:"frappedesk.api.ticket.get_conversations",params:{ticket_id:this.ticketId},auto:!0}},comments(){return{cache:["HD Ticket","Comments",this.ticketId],url:"frappedesk.extends.client.get_list",params:{doctype:"HD Ticket Comment",fields:["*"],filters:{reference_ticket:this.ticketId},order_by:"creation asc"},auto:!0}}},computed:{conversations(){this.$nextTick(()=>{this.autoScrollToBottom()});const t=this.communications.map(n=>(n.type="Communication",n)),e=this.comments.map(n=>(n.type="Comment",n));return[...t,...e].sort((n,a)=>new Date(n.creation)-new Date(a.creation))||[]},communications(){return this.$resources.communications.data||[]},comments(){return this.$resources.comments.data||[]}},watch:{scrollToBottom(t){t&&this.autoScrollToBottom()}},mounted(){this.$socket.on("new_frappedesk_communication",t=>{t.ticket_id==this.ticketId&&this.$resources.communications.reload()}),this.$socket.on("new_frappedesk_comment",t=>{t.ticket_id==this.ticketId&&this.$resources.comments.reload()})},unmounted(){this.$socket.off("new_frappedesk_communication"),this.$socket.off("new_frappedesk_comment")},updated(){this.userColors={},this.lastColorIndex=-1},methods:{getUserName(t){return(t.sender.first_name?t.sender.first_name:"")+" "+(t.sender.last_name?t.sender.last_name:"")},autoScrollToBottom(){if(this.conversations&&this.conversations.length>0){const[t]=this.$refs["conversation-"+(this.conversations.length-1)];t&&t.scrollIntoView({behavior:"smooth"})}}}},ms={key:0},ps={key:0},fs={key:1,class:"m-4 text-base text-slate-500"},_s={key:1};function vs(t,e,s,n,a,r){const i=x("ConversationCard"),o=x("CommentCard"),m=x("LoadingText");return d(),h("div",null,[r.conversations?(d(),h("div",ms,[r.conversations.length>0?(d(),h("div",ps,[(d(!0),h(N,null,L(r.conversations,(l,g)=>(d(),h("div",{key:l.name,ref_for:!0,ref:"conversationContainer"},[c("div",{ref_for:!0,ref:`conversation-${g}`},[l.type=="Communication"?(d(),h("div",{key:0,class:W(["border-gray-100",`
								${g!=0&&r.conversations[g-1].type==="Comment"?"border-t":""} 
								${g!=r.conversations.length-1?"border-b":""}
							`])},[p(i,{"user-name":r.getUserName(l),"profile-pic-url":l.sender.image?l.sender.image:l.sender.user_image,time:l.creation,message:l.content,attachments:l.attachments,cc:l.cc,bcc:l.bcc},null,8,["user-name","profile-pic-url","time","message","attachments","cc","bcc"])],2)):(d(),$(o,{key:1,comment:l},null,8,["comment"]))],512)]))),128))])):(d(),h("div",fs,"Nothing to show"))])):(d(),h("div",_s,[p(m)]))])}const gs=Z(hs,[["render",vs]]),ys={name:"ActivityCard",components:{CustomIcons:Y},props:["activity","isLast"],methods:{capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}}},xs={key:0,class:"pb-[20px] space-x-[17.78px] flex flex-row select-none text-[12px]"},ks={key:0,class:"h-full border-l mx-2"},bs={key:1,class:"h-[20px] border-l mx-2"},ws={class:"grow pr-[6px]"},Cs={class:"flex flex-col text-gray-700"},Ts={class:"font-normal"},Is={class:"flex flex-row space-x-1"},Ss=c("div",null,"by",-1),Es={class:"font-medium"},Os=["title"];function As(t,e,s,n,a,r){const i=x("CustomIcons");return s.activity?(d(),h("div",xs,[c("div",null,[p(i,{class:"h-4 w-4",name:"disc"}),s.isLast?T("",!0):(d(),h("div",ks)),s.isLast?T("",!0):(d(),h("div",bs))]),c("div",ws,[c("div",Cs,[c("div",null,[c("div",Ts,S(r.capitalizeFirstLetter(s.activity.action)),1),c("div",Is,[Ss,c("div",Es,S(s.activity.owner),1)])]),c("a",{class:"text-gray-600 text-[11px] text-normal",title:t.$dayjs(s.activity.creation)},S(t.$dayjs.longFormating(t.$dayjs(s.activity.creation).fromNow())),9,Os)])])])):T("",!0)}const Rs=Z(ys,[["render",As]]),Ns={props:["ticketId"],components:{ActivityCard:Rs},computed:{activities(){return this.$resources.activities.data||null}},mounted(){this.$socket.on("list_update",t=>{t.doctype=="HD Ticket Activity"&&t.name.split("-")[1]==this.ticketId&&this.$resources.activities.fetch()})},unmounted(){this.$socket.off("list_update")},resources:{activities(){return{cache:["Activities","Info Panel",this.ticketId],url:"frappedesk.api.ticket.activities",params:{name:this.ticketId},auto:!0}}}},Ls={class:"pt-[8px]"};function js(t,e,s,n,a,r){const i=x("ActivityCard");return d(),h("div",Ls,[(d(!0),h(N,null,L(r.activities,(o,m)=>(d(),h("div",{key:o.name},[p(i,{activity:o,isLast:m==r.activities.length-1},null,8,["activity","isLast"])]))),128))])}const Ds=Z(Ns,[["render",js]]),Ms={name:"ContactInfo",props:["contactId"],components:{FeatherIcon:J,CustomAvatar:He,CustomIcons:Y},computed:{contact(){return this.$resources.contact.doc||null},contactFullName(){if(this.contact)return((this.contact.first_name||"")+" "+(this.contact.last_name||"")).slice(0,40)}},resources:{contact(){return{type:"document",doctype:"Contact",name:this.contactId}}}},$s={key:0,class:"space-y-[12px]"},Zs={class:"flex flex-row items-center space-x-[12px]"},Ps=["title"],Vs={key:0,class:"flex space-x-[12px] items-center"},Bs=["title"],Fs={key:1,class:"flex space-x-[12px]"},Us=["title"],zs=["title"],Hs={key:2,class:"flex space-x-[12px]"},Ws={class:"text-gray-700 text-base"},qs=["title"];function Ks(t,e,s,n,a,r){const i=x("CustomAvatar"),o=x("FeatherIcon"),m=x("CustomIcons");return r.contact?(d(),h("div",$s,[c("div",Zs,[p(i,{label:r.contactFullName,imageURL:r.contact?.image,size:"md",class:"ml-[-6.5px]"},null,8,["label","imageURL"]),c("a",{title:r.contactFullName,class:"grow truncate font-normal text-base"},S(r.contactFullName),9,Ps)]),r.contact.phone_nos.length>0?(d(),h("div",Vs,[p(o,{name:"phone",class:"stroke-gray-500",style:{width:"15px"}}),(d(!0),h(N,null,L(r.contact.phone_nos,l=>(d(),h("div",{class:"space-y-1",key:l},[c("a",{title:l.phone,class:"text-gray-700 text-base"},S(l.phone),9,Bs)]))),128))])):T("",!0),r.contact.email_ids.length>0?(d(),h("div",Fs,[p(o,{name:"mail",class:"stroke-gray-500 mt-[2.5px]",style:{width:"15px",height:"15px"}}),(d(!0),h(N,null,L(r.contact.email_ids,l=>(d(),h("div",{class:"space-y-1 max-w-[173px] break-words",key:l},[c("div",{title:l.email_id,class:"text-gray-700 text-base"},[c("a",{title:l.email_id},S(l.email_id),9,zs)],8,Us)]))),128))])):T("",!0),r.contact.links.length>0?(d(),h("div",Hs,[p(m,{name:"customer",class:"stroke-gray-500 mt-[2.5px]",style:{width:"15px",height:"15px"}}),(d(!0),h(N,null,L(r.contact.links,l=>(d(),h("div",{class:"space-y-1 max-w-[173px] break-words",key:l},[c("div",Ws,[c("a",{title:l.link_name,class:"grow truncate font-normal text-base"},S(l.link_name),9,qs)])]))),128))])):T("",!0)])):T("",!0)}const Js=Z(Ms,[["render",Ks]]),Ys={name:"InfoPanel",props:["ticketId"],components:{FeatherIcon:J,Input:lt,CustomIcons:Y,Activities:Ds,Autocomplete:gt,ContactInfo:Js},setup(){const t=Ae("viewportWidth"),e=O(!1),s=O(!1);return{viewportWidth:t,showTicketHistory:s,showOtherTicketsOfContacts:e}},computed:{otherTicketsOfContact(){return this.$resources.otherTicketsOfContact.data||null},getOffsetHeight(){return 290+30*(this.showOtherTicketsOfContacts?this.otherTicketsOfContact.length<=5?this.otherTicketsOfContact.length:5:0)},ticket(){return this.$resources.ticket.doc||null}},resources:{otherTicketsOfContact(){return{cache:["Other Tickets","Action Panel",this.ticketId],url:"frappedesk.api.ticket.get_other_tickets_of_contact",params:{ticket_id:this.ticketId},auto:!0}},ticket(){return{type:"document",doctype:"HD Ticket",name:this.ticketId}}}},Gs={key:0,class:"pt-[20px] h-full flex flex-col"},Xs={class:"shrink-0 text-base pb-[17px]"},Qs={key:0,class:"space-y-[12px]"},en={class:"flex flex-row items-center space-x-[12px]"},tn={class:"w-7"},sn=["title"],nn={class:"flex"},rn={key:0,class:"flex space-x-[12px] items-center"},an=["title"],on={key:1,class:"flex space-x-[12px]"},cn=["title"],ln=["title"],dn={class:"flex space-x-[12px]"},un={class:"text-gray-700 text-base"},hn=["title"],mn={class:"shrink-0 text-base px-[16px] pb-[17px] border-b"},pn={class:"grow"},fn={class:"h-full flex flex-col"},_n={key:0,class:"p-[16px] border-t border-b"},vn={class:"space-y-[12px] text-[12px]"},gn={class:"space-y-[12px]"},yn=["title","href"],xn={class:"space-y-[12px]"},kn={class:"text-gray-600"},bn={key:0,class:"w-fit flex flex-row items-center space-x-[12px] cursor-pointer hover:underline"},wn={class:"w-[200px] truncate"},Cn=["title","href"],Tn={key:1},In={class:"flex flex-row items-center space-x-[12px]"},Sn={class:"w-[200px] truncate"},En=["title"],On={key:1,class:"shrink-0 border-b p-[16px] space-y-1 select-none"},An={class:"grow text-gray-600 text-[11px] font-semibold"},Rn={key:0,class:"overflow-auto pt-[4px] space-y-[4px] text-gray-700 font-normal"},Nn=["set"],Ln={class:"py-[1px]"},jn={key:0,class:"flex flex-row space-x-[12px] items-center hover:bg-gray-100"},Dn={class:"w-[15px] h-[15px]"},Mn={class:"max-w-[180px]"},$n={class:"truncate"},Zn=["title"],Pn={key:1,class:"hover:text-gray-600 flex flex-row-reverse text-[11px]"},Vn={class:"h-full"},Bn=c("div",{class:"grow text-gray-600 text-[11px] font-semibold"}," TICKET HISTORY ",-1);function Fn(t,e,s,n,a,r){const i=x("CustomAvatar"),o=x("FeatherIcon"),m=x("CustomIcons"),l=x("ContactInfo"),g=x("router-link"),R=x("Activities");return r.ticket?(d(),h("div",Gs,[c("div",Xs,[c("div",null,[t.contact?(d(),h("div",Qs,[c("div",en,[c("div",tn,[p(i,{label:t.contactFullName,imageURL:t.contact?.image,size:"md"},null,8,["label","imageURL"])]),c("a",{title:t.contactFullName,class:"grow truncate font-normal text-base"},S(t.contactFullName),9,sn),c("div",nn,[p(o,{name:"edit-2",class:"stroke-slate-400 w-4 h-4 cursor-pointer",onClick:e[0]||(e[0]=()=>{t.editingContact=!t.editingContact})})])]),t.contact.phone_nos.length>0?(d(),h("div",rn,[p(o,{name:"phone",class:"stroke-gray-500",style:{width:"15px"}}),(d(!0),h(N,null,L(t.contact.phone_nos,v=>(d(),h("div",{class:"space-y-1",key:v},[c("a",{title:v.phone,class:"text-gray-700 text-base"},S(v.phone),9,an)]))),128))])):T("",!0),t.contact.email_ids.length>0?(d(),h("div",on,[p(o,{name:"mail",class:"stroke-gray-500 mt-[2.5px]",style:{width:"15px",height:"15px"}}),(d(!0),h(N,null,L(t.contact.email_ids,v=>(d(),h("div",{class:"space-y-1 max-w-[173px] break-words",key:v},[c("div",{title:v.email_id,class:"text-gray-700 text-base"},[c("a",{title:v.email_id},S(v.email_id),9,ln)],8,cn)]))),128))])):T("",!0),c("div",dn,[p(m,{name:"customer",class:"stroke-gray-500 mt-[2.5px]",style:{width:"15px",height:"15px"}}),c("div",un,[c("a",{title:r.ticket.customer,class:"grow truncate font-normal text-base"},S(r.ticket.customer),9,hn)])])])):T("",!0)]),c("div",mn,[p(l,{contactId:r.ticket.contact},null,8,["contactId"])]),c("div",pn,[c("div",fn,[r.ticket.custom_fields.length>0?(d(),h("div",_n,[c("div",vn,[c("div",gn,[(d(!0),h(N,null,L(r.ticket.custom_fields.filter(v=>v.is_action_field=="1"),v=>(d(),h("div",{class:"flex flex-col space-y-[8px] font-normal hover:underline",key:v.fieldname},[c("a",{title:v.value,href:v.route,target:"_blank"},S(v.label),9,yn)]))),128))]),c("div",xn,[(d(!0),h(N,null,L(r.ticket.custom_fields.filter(v=>v.is_action_field!="1"),v=>(d(),h("div",{class:"flex flex-col space-y-[8px] font-normal",key:v.fieldname},[c("div",kn,S(v.label),1),v.route?(d(),h("div",bn,[p(o,{name:"external-link",class:"w-[14px] h-[14px] stroke-gray-500"}),c("div",wn,[c("a",{title:v.value,class:"text-gray-900 text-base",href:v.route,target:"_blank"},S(v.value),9,Cn)])])):(d(),h("div",Tn,[c("div",In,[p(o,{name:"info",class:"w-[14px] h-[14px] stroke-gray-500"}),c("div",Sn,[c("a",{title:v.value,class:"text-gray-900 text-base w-[200px]"},S(v.value),9,En)])])]))]))),128))])])])):T("",!0),r.otherTicketsOfContact?(d(),h("div",On,[c("div",{class:W(["flex flex-row items-center",r.otherTicketsOfContact.length>0?"cursor-pointer":""]),onClick:e[1]||(e[1]=()=>{n.showOtherTicketsOfContacts=!n.showOtherTicketsOfContacts})},[c("div",An," OPEN TICKETS ("+S(r.otherTicketsOfContact.length)+") ",1),r.otherTicketsOfContact.length>0?(d(),$(o,{key:0,class:"h-[15px] w-[15px] stroke-gray-500",name:n.showOtherTicketsOfContacts?"chevron-up":"chevron-down"},null,8,["name"])):T("",!0)],2),n.showOtherTicketsOfContacts&&r.otherTicketsOfContact.length>0?(d(),h("div",Rn,[(d(!0),h(N,null,L(r.otherTicketsOfContact,(v,G)=>(d(),h("div",{key:v.name,set:t.maxCount=5},[G<=t.maxCount?(d(),$(g,{key:0,to:G<t.maxCount?`/frappedesk/tickets/${v.name}`:`/frappedesk/tickets/?contact=${JSON.stringify(["is",r.ticket.contact])}`,class:"text-[12px] rounded"},{default:j(()=>[c("div",Ln,[G<t.maxCount?(d(),h("div",jn,[c("div",Dn,[p(o,{name:"arrow-up-right",class:"w-[15px] h-[15px] stroke-gray-500"})]),c("div",Mn,[c("div",$n,[c("a",{class:"text-[12px]",title:v.subject},S(v.subject),9,Zn)])])])):(d(),h("div",Pn," View all "))])]),_:2},1032,["to"])):T("",!0)],8,Nn))),128))])):T("",!0)])):T("",!0),c("div",Vn,[c("div",{class:W(["flex flex-col p-[16px] select-none",n.showTicketHistory?"":"border-b"])},[c("div",{class:"shrink-0 flex flex-row items-center cursor-pointer",onClick:e[2]||(e[2]=()=>{n.showTicketHistory=!n.showTicketHistory})},[Bn,p(o,{class:"h-[15px] w-[15px] stroke-gray-500",name:n.showTicketHistory?"chevron-up":"chevron-down"},null,8,["name"])]),n.showTicketHistory?(d(),h("div",{key:0,class:"overflow-y-auto",style:Oe({height:n.viewportWidth>768?`calc(100vh - ${r.getOffsetHeight}px)`:null})},[p(R,{ticketId:r.ticket.name},null,8,["ticketId"])],4)):T("",!0)],2)])])])])])):T("",!0)}const Un=Z(Ys,[["render",Fn]]);const zn={name:"ActionPanel",props:["ticketId"],components:{Badge:Qe,FeatherIcon:J,TicketField:yt,CustomIcons:Y},setup(){return{validationErrorFields:O([])}},mounted(){document.addEventListener("keydown",this.handleShortcuts.bind(this))},unmounted(){document.removeEventListener("keydown",this.handleShortcuts)},updated(){var t=document.querySelectorAll(".error-animation");setTimeout(function(){[].forEach.call(t,function(e){e.classList.remove("error-animation")})},820)},computed:{customFields(){return this.$resources.customFields.data||null},ticket(){return this.$resources.ticket.doc||null}},resources:{customFields(){return{url:"frappedesk.api.ticket.get_custom_fields",params:{doctype:"HD Ticket",view:"Agent Portal"},auto:!0}},ticket(){return{type:"document",doctype:"HD Ticket",name:this.ticketId}}},methods:{handleShortcuts(t){if((t.metaKey||t.ctrlKey)&&t.altKey)switch(t.preventDefault(),t.keyCode){case 82:this.updateStatus("Replied");break;case 69:this.updateStatus("Resolved");break;case 67:this.updateStatus("Closed")}},getFormatedDate(t,e){return t?this.$dayjs(t).format(e):""},firstResponseStatus(){return this.ticket.first_responded_on?this.ticket.response_by>this.ticket.first_responded_on?"Success":"Failed":null},resolutionStatus(){switch(this.ticket.agreement_status){case"Resolution Due":return this.ticket.resolution_by?"":"Paused";case"Fulfilled":return"Success";case"Overdue":return"Failed";default:return""}}}},Hn={key:0,class:"flex flex-col h-full"},Wn={class:"pl-[19px] pr-[17px] pt-[18px] pb-[28px] dashes"},qn={class:"text-base space-y-[11px]"},Kn={class:"flex flex-col space-y-[2px]"},Jn={class:"flex flex-row space-x-[5.33px] items-center"},Yn=c("div",{class:"text-gray-600 text-[12px]"}," First Response Due ",-1),Gn={class:"font-normal text-gray-900"},Xn={class:"flex flex-col space-y-[2px]"},Qn={class:"flex flex-row space-x-[5.33px] items-center"},er=c("div",{class:"text-gray-600 text-[12px]"}," Resolution Due ",-1),tr={class:"font-normal text-gray-900"},sr=c("div",null,[c("span",{class:"dot fixed ml-[-1px] mt-[-10.5px] bg-gray-50 border-r border-t border-b"}),c("span",{class:"dot rotate-180 fixed ml-[241.5px] mt-[-10.5px] bg-white border-r border-t border-b"})],-1),nr={class:"px-[19px] py-[28px] h-full overflow-y-auto flex flex-col space-y-2.5"},rr={class:"flex flex-col space-y-[12px]"};function ar(t,e,s,n,a,r){const i=x("CustomIcons"),o=x("Badge"),m=x("TicketField");return r.ticket?(d(),h("div",Hn,[c("div",Wn,[c("div",qn,[c("div",Kn,[c("div",Jn,[Yn,r.firstResponseStatus()?(d(),$(i,{key:0,name:{Success:"sla-pass",Failed:"sla-fail"}[r.firstResponseStatus()],class:"w-[16px] h-[16px]"},null,8,["name"])):T("",!0)]),c("div",Gn,S(r.getFormatedDate(r.ticket.response_by,"ddd, MMM DD, HH:mm")),1)]),c("div",Xn,[c("div",Qn,[er,r.resolutionStatus()!="Paused"?(d(),$(i,{key:0,name:{Success:"sla-pass",Failed:"sla-fail"}[r.resolutionStatus()],class:"w-[16px] h-[16px]"},null,8,["name"])):(d(),$(o,{key:1,color:"blue"},{default:j(()=>[te("Paused")]),_:1}))]),c("div",tr,S(r.getFormatedDate(r.ticket.resolution_by,"ddd, MMM DD, HH:mm")),1)])])]),sr,c("div",nr,[c("div",{class:W(["flex flex-col space-y-[12px] pb-5",{"border-b":r.customFields?.length>0}])},[(d(),h(N,null,L(["_assign","status","ticket_type","priority","agent_group"],l=>c("div",{key:l},[p(m,{ref_for:!0,ref:`field-${l}-input`,ticketId:r.ticket.name,fieldname:l,editable:!0,validate:function(){return n.validationErrorFields.includes(l)&&n.validationErrorFields.splice(n.validationErrorFields.indexOf(l),1),l==="status"&&!r.ticket.ticket_type?(n.validationErrorFields.push("ticket_type"),!1):!0},triggerValidationError:n.validationErrorFields.includes(l)},null,8,["ticketId","fieldname","validate","triggerValidationError"])])),64))],2),c("div",rr,[(d(!0),h(N,null,L(r.customFields,l=>(d(),h("div",{key:l.fieldname},[p(m,{ticketId:r.ticket.name,fieldname:l.fieldname,editable:l.is_editable_by_agent},null,8,["ticketId","fieldname","editable"])]))),128))])])])):T("",!0)}const ir=Z(zn,[["render",ar]]),or={name:"Accordion",components:{CustomIcons:Y},data(){return{isOpen:!1}},methods:{toggleAccordion(){this.isOpen=!this.isOpen}}},cr=["aria-expanded","aria-controls"],lr=["id"];function dr(t,e,s,n,a,r){const i=x("CustomIcons");return d(),h("div",null,[c("button",{onClick:e[0]||(e[0]=o=>r.toggleAccordion()),class:"flex items-center space-x-3","aria-expanded":a.isOpen,"aria-controls":`collapse${t._uid}`},[p(i,{class:W({"rotate-180":a.isOpen,"rotate-0":!a.isOpen}),name:"chevron-down-accordion"},null,8,["class"]),qe(t.$slots,"title")],8,cr),Re(c("div",{id:`collapse${t._uid}`},[qe(t.$slots,"content")],8,lr),[[Ne,a.isOpen]])])}const rt=Z(or,[["render",dr]]),ur={name:"CannedResponsesDialog",props:["show"],components:{Dialog:et,FeatherIcon:J,Accordion:rt,CustomIcons:Y},setup(){const t=O([]),e=O("");return tt("tempMessage",e),{listManager:t,tempMessage:e}},data(){return{cannedResponses:[]}},methods:{close(){this.$emit("close"),this.$emit("messageVal",this.tempMessage)},emitMessage(){this.$emit("messageVal",this.tempMessage)},addMessage(t){this.tempMessage=t.message},getCannedResponses(t){let e=t;this.$resources.list.fetch({title:e})}},resources:{list(){return{url:"frappedesk.api.cannedResponse.get_canned_response",onSuccess(t){return this.cannedResponses=t,this.cannedResponses}}}},beforeMount(){this.getCannedResponses()}},hr={class:"border-b border-grey-400 w-full pl-2 pb-4 absolute left-0 top-0 px-4 py-3 sm:px-6 flex justify-between items-center"},mr=c("div",{class:""},"Canned Responses",-1),pr={class:"w-full border bg-[#EBEEF0] h-8 flex flex-row items-center space-x-3 mt-5 rounded mb-3"},fr={class:"divide-y divide-slate-200 max-h-[256px] overflow-y-auto"},_r={class:"relative py-3"},vr={class:"font-medium text-lg"},gr=["innerHTML"];function yr(t,e,s,n,a,r){const i=x("Button"),o=x("FeatherIcon"),m=x("Input"),l=x("CustomIcons"),g=x("Accordion"),R=x("Dialog");return d(),h("div",null,[p(R,{options:{title:" ",size:"2xl"},show:s.show,onClose:e[2]||(e[2]=v=>r.close())},{"body-content":j(()=>[c("div",hr,[mr,p(i,{icon:"x",class:"bg-transparent w-2 h-2",onClick:e[0]||(e[0]=v=>r.close())})]),c("div",pr,[p(o,{name:"search",class:"h-4 w-4 stroke-gray-500 ml-[8px]"}),p(m,{modelValue:t.search,"onUpdate:modelValue":e[1]||(e[1]=v=>t.search=v),id:"searchInput",class:"grow text-[12px] text-left text-black border-0 bg-[#EBEEF0] h-[31px] rounded-none pl-0",type:"text",placeholder:"Search for response",onInput:r.getCannedResponses},null,8,["modelValue","onInput"])]),c("div",fr,[(d(!0),h(N,null,L(this.cannedResponses,v=>(d(),h("div",_r,[p(l,{name:"add-new",class:"h-7 w-7 rounded p-1 mb-4 absolute right-0",role:"button",onClick:()=>{r.addMessage(v),r.emitMessage(),r.close()}},null,8,["onClick"]),p(g,{class:"my-2"},{title:j(()=>[c("span",vr,S(v.title),1)]),content:j(()=>[c("div",{innerHTML:v.message,class:"ProseMirror prose font-normal text-lg text-slate-500 ml-5 mt-4"},null,8,gr)]),_:2},1024)]))),256))])]),_:1},8,["show"])])}const xr=Z(ur,[["render",yr]]),kr={name:"ArticleResponseDialog",props:["show"],components:{Dialog:et,FeatherIcon:J,Accordion:rt,CustomIcons:Y},setup(){const t=O([]),e=O("");return tt("tempContent",e),{listManager:t,tempContent:e}},data(){return{articleResponses:[]}},methods:{close(){this.$emit("close"),this.$emit("contentVal",this.tempContent)},emitContent(){this.$emit("ContentVal",this.tempContent)},addContent(t){this.tempContent=t.content},getArticles(t){let e=t;this.$resources.list.fetch({title:e})}},resources:{list(){return{url:"frappedesk.api.kb.get_articles_in_ticket",onSuccess(t){return this.articleResponses=t,this.articleResponses}}}},beforeMount(){this.getArticles()}},br={class:"border-b border-grey-400 w-full pl-2 pb-4 absolute left-0 top-0 px-4 py-3 sm:px-6 flex justify-between items-center"},wr=c("div",{class:""},"Articles",-1),Cr={class:"w-full border bg-[#EBEEF0] h-8 flex flex-row items-center space-x-3 mt-5 rounded mb-3"},Tr={class:"divide-y divide-slate-200 max-h-[256px] overflow-y-auto"},Ir={class:"relative py-3"},Sr={class:"font-medium text-lg"},Er=["innerHTML"];function Or(t,e,s,n,a,r){const i=x("Button"),o=x("FeatherIcon"),m=x("Input"),l=x("CustomIcons"),g=x("Accordion"),R=x("Dialog");return d(),h("div",null,[p(R,{options:{title:" ",size:"2xl"},show:s.show,onClose:e[2]||(e[2]=v=>r.close())},{"body-content":j(()=>[c("div",br,[wr,p(i,{icon:"x",class:"bg-transparent w-2 h-2",onClick:e[0]||(e[0]=v=>r.close())})]),c("div",Cr,[p(o,{name:"search",class:"h-4 w-4 stroke-gray-500 ml-[8px]"}),p(m,{modelValue:t.search,"onUpdate:modelValue":e[1]||(e[1]=v=>t.search=v),id:"searchInput",class:"grow text-[12px] text-left text-black border-0 bg-[#EBEEF0] h-[31px] rounded-none pl-0",type:"text",placeholder:"Search for response",onInput:r.getArticles},null,8,["modelValue","onInput"])]),c("div",Tr,[(d(!0),h(N,null,L(this.articleResponses,v=>(d(),h("div",Ir,[p(l,{name:"add-new",class:"h-7 w-7 rounded p-1 mb-4 absolute right-0",role:"button",onClick:()=>{r.addContent(v),r.emitContent(),r.close()}},null,8,["onClick"]),p(g,{class:"my-2"},{title:j(()=>[c("span",Sr,S(v.title),1)]),content:j(()=>[c("div",{innerHTML:v.content,class:"ProseMirror prose font-normal text-lg text-slate-500 ml-5 mt-4"},null,8,Er)]),_:2},1024)]))),256))])]),_:1},8,["show"])])}const Ar=Z(kr,[["render",Or]]),Rr=["Paragraph",["Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"],Nr={name:"Ticket",components:{ActionPanel:ir,ArticleResponseDialog:Ar,Avatar:ut,Badge:Qe,CannedResponsesDialog:xr,Card:ht,Conversations:gs,CustomIcons:Y,CustomerSatisfactionFeedback:xt,Dropdown:mt,ErrorMessage:pt,FeatherIcon:J,FileUploader:ft,InfoPanel:Un,TextEditor:st,TextEditorFixedMenu:_t,TicketStatus:kt},props:{ticketId:String},setup(){const t=O(!0),e=Ae("viewportWidth"),s=dt(),n=Ae("agents"),a=O([]),r=O(""),i=O("Replied"),o=O({}),m=O(!1),l=O(""),g=O(!1),R=O(""),v=O(""),G=O(!1),we=O(!1),Ce=O(!0),Te=O(!0),Ie=O([]),Se=O([]);return{ccList:Ie,bccList:Se,showTextFormattingMenu:t,viewportWidth:e,authStore:s,agents:n,attachments:a,tempTextEditorData:o,editingType:r,showCannedResponsesDialog:m,tempMessage:l,showArticleResponseDialog:g,tempContent:R,editingSubject:v,replied:i,showCc:G,showBcc:we,showCcBtn:Ce,showBccBtn:Te,replied:i}},data(){return{editing:!1,scrollConversationsToBottom:!1,content:"",textEditorMenuButtons:Rr}},resources:{ticket(){return{type:"document",doctype:"HD Ticket",name:this.ticketId,onSuccess:()=>{this.$resources.ticket.lastCommunication.fetch()},whitelistedMethods:{lastCommunication:{method:"last_communication",onSuccess:t=>{this.ccList=this.ccList.length?this.ccList:t.cc?.split(",")||[],this.bccList=this.bccList.length?this.bccList:t.bcc?.split(",")||[]}},markSeen:"mark_seen",replyViaAgent:{method:"reply_via_agent",onSuccess:()=>{this.tempTextEditorData={},this.editing=!1},onError:({error:t})=>{this.content=this.tempTextEditorData.content,this.attachments=this.tempTextEditorData.attachments;const e=t?.messages?.filter((s,n,a)=>a.indexOf(s)==n)?.join(`
`);e&&this.$toast({text:e,icon:"x",iconClasses:"text-red-500"})}}}}},submitComment(){return{url:"frappe.client.insert",onSuccess:()=>{this.tempTextEditorData={},this.editing=!1},onError:()=>{this.content=this.tempTextEditorData.content,this.attachments=this.tempTextEditorData.attachments}}}},computed:{ticket(){return this.$resources.ticket.doc||null},sendingDissabled(){let t=this.content.trim();return t=t.replaceAll("<p></p>",""),t=t.replaceAll(" ",""),(t==""||t=="<p><br></p>"||t=="<p></p>")&&this.attachments.length==0},mentions(){return(this.editingType==="comment"?this.agents:[]).map(e=>({label:e.agent_name,value:e.name}))}},mounted(){this.$resources.ticket.markSeen.submit()},methods:{async copyTicketName(){this.$clipboardCopy(this.ticket.name)},startEditing(t="reply"){this.editing=!0,this.editingType=t,this.delayedConversationScroll(),this.$nextTick(()=>{this.$refs.replyEditor.editor.commands.focus()})},cancelEditing(){this.editing=!1},delayedConversationScroll(){function t(e){return new Promise(s=>setTimeout(s,e))}t(400).then(()=>this.scrollConversationsToBottom=!0),t(1e3).then(()=>this.scrollConversationsToBottom=!1)},handleShortcuts(t){(t.metaKey||t.ctrlKey)&&t.keyCode===13?this.sendingDissabled||this.submit():(t.metaKey||t.ctrlKey)&&t.keyCode===75?this.$refs.replyEditor.editor.commands.insertLink():t.keyCode===27&&this.cancelEditing()},submit(){switch(this.editingType){case"reply":this.submitConversation();break;case"comment":this.submitComment();break}},submitConversation(){this.tempTextEditorData.content=this.content,this.tempTextEditorData.attachments=this.attachments;const t=`<div class='content-block'><div>${this.content}</div></div>`;this.$resources.ticket.replyViaAgent.submit({attachments:this.attachments.map(e=>e.name),bcc:this.bccList.join(","),cc:this.ccList.join(","),message:t}),this.content="",this.attachments=[]},submitAndUpdateTicketStatus(t){this.$resources.ticket.update.submit({status:t}),this.submitConversation()},submitResolvedTicket(){this.tempTextEditorData.content=this.content,this.tempTextEditorData.attachments=this.attachments;const t=`<div class='content-block'><div>${this.content}</div></div>`;this.$resources.ticket.update.submit({status:"Resolved"}),this.$resources.ticket.replyViaAgent.submit({message:t,attachments:this.attachments.map(e=>e.name)}),this.content="",this.attachments=[]},submitComment(){this.tempTextEditorData.attachments=this.attachments,this.tempTextEditorData.content=this.content;const t=`<div class='content-block'><div>${this.content}</div></div>`;this.$resources.submitComment.submit({doc:{doctype:"HD Ticket Comment",reference_ticket:this.ticketId,content:t,commented_by:this.authStore.userId}}),this.content="",this.attachments=[]},getMessage(t){this.tempMessage=t,this.content=this.tempMessage},getContent(t){this.tempContent=t,this.content=this.tempContent},validateEmail(t){return Mt().email().safeParse(t).success},pushToEmailList(t,e){if(typeof e=="string"){if(!this.validateEmail(e))return;t.push(e);return}if(!(t.indexOf(e.target.value)>0)){if(!this.validateEmail(e.target.value)){this.$toast({title:"Invalid email",icon:"x",iconClasses:"text-red-500"});return}t.push(e.currentTarget.value),e.currentTarget.value=""}},removeFromEmailList(t,e){t.splice(t.indexOf(e),1)},onEmailListPaste(t,e){const s=e.clipboardData.getData("text/plain"),n=s.includes(",")?",":" ";s.split(n).map(a=>a.trim()).forEach(a=>this.pushToEmailList(t,a))}}},Lr={class:"overflow-hidden"},jr={key:0,class:"flex h-screen grow-0 flex-col"},Dr={class:"flex h-[60px] px-[20px]"},Mr={class:"flex flex-row items-center space-x-2"},$r={class:"w-[252px] shrink-0 border-r"},Zr={class:"border-b py-[14px] px-[18px]"},Pr={class:"flex flex-row justify-between"},Vr={class:"grow"},Br={class:"flex grow flex-row items-center space-x-[13.5px]"},Fr={key:0,class:"flex grow items-center justify-between"},Ur=["title"],zr={key:1,class:"flex grow items-center justify-between gap-2"},Hr={class:"flex flex-row gap-2"},Wr={class:"grow overflow-y-scroll px-[17px]"},qr={class:"mb-[15px] flex shrink-0 flex-col space-y-[11px] px-[18px] pt-2"},Kr={class:"flex flex-row border-b-[1px] border-[#F4F5F6] pb-[8px] text-[12px] font-normal"},Jr={key:0,class:"flex flex-col gap-2"},Yr={key:0,class:"flex flex-row items-center gap-2"},Gr=c("div",{class:"text-gray-700"},"To",-1),Xr={class:"rounded-md bg-gray-100 px-2 py-1"},Qr={class:"flex flex-row flex-wrap items-center gap-2"},ea=c("div",{class:"text-gray-700"},"Cc",-1),ta={class:"px-2 py-1"},sa={class:"flex flex-row flex-wrap items-center gap-2"},na=c("div",{class:"text-gray-700"},"Bcc",-1),ra={class:"px-2 py-1"},aa={key:1,class:"flex flex-row items-center space-x-2"},ia=c("span",{class:"text-gray-700"},"as",-1),oa=c("span",{class:"rounded-[6px] border border-gray-400 bg-[#FDF9F2] px-[10px] py-[4px] text-[11px] font-normal text-gray-900 shadow"},"Comment",-1),ca=[ia,oa],la={class:"flex grow flex-row-reverse gap-1.5"},da={key:0},ua={key:0,class:"flex max-h-[100px] flex-col overflow-y-scroll rounded"},ha={class:"flex flex-wrap gap-2 py-2"},ma=["title"],pa={class:"flex flex-row items-center space-x-1"},fa={class:"ml-2 max-w-[100px] truncate text-[12px] font-normal text-gray-700"},_a=["onClick"],va={key:1},ga={key:2,class:"flex select-none flex-row items-center gap-2 space-x-2 pt-2"},ya={class:"flex"},xa={class:"flex flex-row items-center space-x-2"},ka={class:"flex grow flex-row-reverse"},ba={key:0,class:"flex flex-row space-x-[14px]"},wa={class:"w-[252px] shrink-0 border-l bg-gray-50"};function Ca(t,e,s,n,a,r){const i=x("FeatherIcon"),o=x("router-link"),m=x("TicketStatus"),l=x("ActionPanel"),g=x("CustomIcons"),R=x("Input"),v=x("Button"),G=x("CustomerSatisfactionFeedback"),we=x("Conversations"),Ce=x("TextEditorFixedMenu"),Te=x("Dropdown"),Ie=x("FileUploader"),Se=x("CannedResponsesDialog"),at=x("ArticleResponseDialog"),it=x("TextEditor"),ot=x("InfoPanel");return d(),h("div",Lr,[r.ticket?(d(),h("div",jr,[c("div",Dr,[c("div",Mr,[p(o,{to:{path:"/frappedesk/tickets"},class:"flex select-none flex-row items-center space-x-[12px] stroke-gray-600 text-[18px] font-semibold text-gray-900 hover:stroke-gray-700",role:"button"},{default:j(()=>[p(i,{name:"arrow-left",class:"h-[12px] w-[12px]"}),c("div",null,"Ticket #"+S(r.ticket.name),1)]),_:1}),p(m,{value:r.ticket.status},null,8,["value"]),p(i,{name:"copy",class:"h-[24px] w-[24px] rounded-md bg-gray-100 stroke-gray-700 p-1",role:"button",onClick:r.copyTicketName},null,8,["onClick"])])]),r.ticket?(d(),h("div",{key:0,class:"flex w-full border-t",style:Oe({height:n.viewportWidth>768?"calc(100vh - 60px)":null})},[c("div",$r,[p(l,{"ticket-id":r.ticket.name},null,8,["ticket-id"])]),c("div",{class:"flex h-full grow flex-col",style:Oe({width:"calc(100vh - 252px - 240px - 252px)"})},[c("div",Zr,[c("div",Pr,[c("div",Vr,[c("div",Br,[c("div",null,[r.ticket.via_customer_portal?(d(),$(g,{key:0,name:"comment",class:"h-[25px] w-[25px] stroke-[#A6B1B9]"})):(d(),$(i,{key:1,name:"mail",class:"h-[25px] w-[25px] stroke-[#A6B1B9] p-[1.5px]"}))]),n.editingSubject?(d(),h("div",zr,[p(R,{id:"subjectInput",class:"w-full",value:r.ticket.subject,type:"text",onChange:e[1]||(e[1]=k=>t.subject=k)},null,8,["value"]),c("div",Hr,[p(v,{appearance:"primary",onClick:e[2]||(e[2]=()=>{t.$resources.ticket.setValue.submit({subject:t.subject}).then(n.editingSubject=!1)})},{default:j(()=>[te("Save")]),_:1}),p(v,{appearance:"secondary",onClick:e[3]||(e[3]=k=>t.$router.go())},{default:j(()=>[te("Discard")]),_:1})])])):(d(),h("div",Fr,[c("a",{title:r.ticket.subject,class:"cursor-pointer truncate font-semibold sm:max-w-[200px] lg:max-w-[550px]"},S(r.ticket.subject),9,Ur),p(i,{class:"h-4 w-4 cursor-pointer",name:"edit",onClick:e[0]||(e[0]=k=>n.editingSubject=!0)})]))])])])]),c("div",Wr,[r.ticket.feedback_submitted&&["Closed","Resolved"].includes(r.ticket.status)?(d(),$(G,{key:0,"from-desk":!0,class:"mt-[10px]",editable:!1,ticket:r.ticket},null,8,["ticket"])):T("",!0),p(we,{"ticket-id":r.ticket.name,"scroll-to-bottom":a.scrollConversationsToBottom,"auto-scroll":["Open","Replied"].includes(r.ticket.status)},null,8,["ticket-id","scroll-to-bottom","auto-scroll"])]),c("div",qr,[a.editing?(d(),$(it,{key:0,ref:"replyEditor",content:a.content,"editor-class":"text-[13px] min-h-[180px] max-h-[300px] max-w-full overflow-y-scroll",mentions:r.mentions,placeholder:n.editingType=="reply"?"Type a response":"Type a comment",class:"rounded-[8px] border border-gray-300 p-[12px]",onKeydown:e[25]||(e[25]=k=>r.handleShortcuts(k)),onChange:e[26]||(e[26]=k=>{a.content=k}),onClick:e[27]||(e[27]=k=>t.$refs.replyEditor.editor.commands.focus())},{top:j(()=>[c("div",Kr,[n.editingType=="reply"?(d(),h("div",Jr,[r.ticket.raised_by?(d(),h("div",Yr,[Gr,c("div",Xr,S(r.ticket.raised_by),1)])):T("",!0),Re(c("div",Qr,[ea,(d(!0),h(N,null,L(n.ccList,k=>(d(),h("div",{class:W(["flex items-center rounded-md bg-gray-100",{"bg-red-100":!r.validateEmail(k)}])},[c("div",ta,S(k),1),p(i,{name:"x",class:"h-5 cursor-pointer py-1 pr-2",onClick:()=>r.removeFromEmailList(n.ccList,k)},null,8,["onClick"])],2))),256)),p(R,{class:"bg-white focus:bg-white",onKeydown:[e[4]||(e[4]=ee(H(k=>r.pushToEmailList(n.ccList,k),["prevent"]),["enter"])),e[5]||(e[5]=ee(H(k=>r.pushToEmailList(n.ccList,k),["prevent"]),["space"])),e[6]||(e[6]=ee(H(k=>r.pushToEmailList(n.ccList,k),["prevent"]),[","]))],onPaste:e[7]||(e[7]=H(k=>r.onEmailListPaste(n.ccList,k),["prevent"]))})],512),[[Ne,n.showCc]]),Re(c("div",sa,[na,(d(!0),h(N,null,L(n.bccList,k=>(d(),h("div",{class:W(["flex items-center rounded-md bg-gray-100",{"bg-red-100":!r.validateEmail(k)}])},[c("div",ra,S(k),1),p(i,{name:"x",class:"h-5 cursor-pointer py-1 pr-2",onClick:()=>r.removeFromEmailList(n.bccList,k)},null,8,["onClick"])],2))),256)),p(R,{class:"bg-white focus:bg-white",onKeydown:[e[8]||(e[8]=ee(H(k=>r.pushToEmailList(n.bccList,k),["prevent"]),["enter"])),e[9]||(e[9]=ee(H(k=>r.pushToEmailList(n.bccList,k),["prevent"]),["space"])),e[10]||(e[10]=ee(H(k=>r.pushToEmailList(n.bccList,k),["prevent"]),[","]))],onPaste:e[11]||(e[11]=H(k=>r.onEmailListPaste(n.bccList,k),["prevent"]))})],512),[[Ne,n.showBcc]])])):(d(),h("div",aa,ca)),c("div",la,[c("a",{role:"button",title:"Hide Editor",onClick:e[12]||(e[12]=(...k)=>r.cancelEditing&&r.cancelEditing(...k))},[p(g,{name:"arrow-down",class:"h-[24px] w-[24px]"})]),n.editingType=="reply"?(d(),h("div",da,[n.showCcBtn?(d(),$(v,{key:0,class:"h-[24px] w-[24px] bg-transparent text-[#4C5A67]",label:"Cc",title:"Cc",onClick:e[13]||(e[13]=()=>{n.showCc=!0,n.showCcBtn=!1})})):T("",!0),n.showBccBtn?(d(),$(v,{key:1,class:"h-[24px] w-[24px] bg-transparent text-[#4C5A67]",appearenece:"secondary",label:"Bcc",title:"Bcc",onClick:e[14]||(e[14]=()=>{n.showBcc=!0,n.showBccBtn=!1})})):T("",!0)])):T("",!0)])])]),bottom:j(()=>[c("div",null,[n.attachments.length?(d(),h("div",ua,[c("ul",ha,[(d(!0),h(N,null,L(n.attachments,k=>(d(),h("li",{key:k,class:"flex items-center space-x-2 rounded border border-gray-400 bg-gray-100 p-1 shadow",title:k.name},[c("div",pa,[p(i,{name:"file-text",class:"h-[15px] stroke-gray-600"}),c("span",fa,S(k.file_name),1)]),c("button",{class:"grid h-4 w-4 place-items-center rounded text-gray-700 hover:bg-gray-300",onClick:()=>{n.attachments=n.attachments.filter(Ee=>Ee.name!=k.name)}},[p(i,{class:"w-3",name:"x"})],8,_a)],8,ma))),128))])])):T("",!0),n.showTextFormattingMenu?(d(),h("div",va,[p(Ce,{class:"my-1 overflow-x-auto rounded border shadow-sm",buttons:a.textEditorMenuButtons},null,8,["buttons"])])):T("",!0),t.$refs.replyEditor?(d(),h("div",ga,[c("div",ya,[n.editingType=="reply"?(d(),$(Te,{key:0,placement:"right",button:{class:"rounded-r-none",disabled:!n.authStore.isAgent&&!n.authStore.isAdmin||r.sendingDissabled,appearance:"primary",label:"Menu",icon:"chevron-up"},options:[{label:"Send and set as Replied",handler:()=>{r.submit(),r.submitAndUpdateTicketStatus("Replied"),t.$router.go()}},{label:"Send and set as Resolved",handler:()=>{r.submit(),r.submitAndUpdateTicketStatus("Resolved"),t.$router.go()}},{label:"Send and set as Closed",handler:()=>{r.submit(),r.submitAndUpdateTicketStatus("Closed"),t.$router.go()}}]},null,8,["button","options"])):T("",!0),p(v,{class:"[&:nth-child(2)]:rounded-l-none",loading:n.editingType=="reply"?t.$resources.ticket.replyViaAgent.loading:t.$resources.submitComment.loading,appearance:"primary",disabled:!n.authStore.isAgent&&!n.authStore.isAdmin||r.sendingDissabled,onClick:e[15]||(e[15]=k=>r.submit())},{default:j(()=>[te(S(n.editingType=="reply"?"Send":"Create"),1)]),_:1},8,["loading","disabled"])]),c("div",xa,[p(g,{class:W([n.showTextFormattingMenu?"bg-gray-200":"","h-7 w-7 rounded p-1"]),name:"text-formatting",role:"button",onClick:e[16]||(e[16]=()=>{n.showTextFormattingMenu=!n.showTextFormattingMenu})},null,8,["class"]),p(Ie,{onSuccess:e[17]||(e[17]=k=>n.attachments.push(k))},{default:j(({progress:k,uploading:Ee,openFileSelector:ct})=>[p(i,{name:"paperclip",class:"h-[17px]",role:"button",disabled:Ee,onClick:ct},null,8,["disabled","onClick"])]),_:1}),p(g,{name:"add-response",class:"h-7 w-7 rounded p-1",role:"button",onClick:e[18]||(e[18]=()=>{n.showCannedResponsesDialog=!0})}),p(g,{name:"article-reply",class:"h-7 w-7 rounded p-1",role:"button",onClick:e[19]||(e[19]=()=>{n.showArticleResponseDialog=!0})}),p(Se,{show:n.showCannedResponsesDialog,onMessageVal:e[20]||(e[20]=k=>r.getMessage(k)),onClose:e[21]||(e[21]=()=>{n.showCannedResponsesDialog=!1})},null,8,["show"]),p(at,{show:n.showArticleResponseDialog,onContentVal:e[22]||(e[22]=k=>r.getContent(k)),onClose:e[23]||(e[23]=()=>{n.showArticleResponseDialog=!1})},null,8,["show"])]),c("div",ka,[p(i,{name:"trash-2",role:"button",class:"h-4 w-4",onClick:e[24]||(e[24]=()=>{a.content="",n.attachments=[],a.editing=!1})})])])):T("",!0)])]),_:1},8,["content","mentions","placeholder"])):T("",!0),c("div",null,[a.editing?T("",!0):(d(),h("div",ba,[p(v,{appearance:"primary",onClick:e[28]||(e[28]=k=>r.startEditing("reply"))},{default:j(()=>[te(" Reply ")]),_:1}),p(v,{appearance:"secondary",disabled:!n.authStore.isAgent&&!n.authStore.isAdmin,onClick:e[29]||(e[29]=k=>r.startEditing("comment"))},{default:j(()=>[te(" Add Comment ")]),_:1},8,["disabled"])]))])])],4),c("div",wa,[p(ot,{"ticket-id":r.ticket.name},null,8,["ticket-id"])])],4)):T("",!0)])):T("",!0)])}const Ba=Z(Nr,[["render",Ca]]);export{Ba as default};
